import{P as K,a as Q,N as ke,S as ge,T as X,A as ds,E as fs}from"./prosemirror-state-CbPVowry.js";import{t as mn}from"./tippy.js-DM9ol-Nf.js";import{g as B,r as G}from"./react-DszLFPtG.js";import{R as ps,r as hs}from"./react-dom-C1leq-tK.js";import{r as Ht,f as gn,t as ms,a as gs}from"./linkifyjs-CPzQtjSI.js";import{E as ys,D as gt,a as yt}from"./prosemirror-view-D2u4awtz.js";import{a as bs,b as ws,d as Ms,c as Es,e as ks,f as Ss,g as xs,m as Dt,s as Bt,t as jt,h as Ts,i as Cs,j as Ft,k as vs,C as yn,l as As,n as Os}from"./prosemirror-tables-D5HyTxhQ.js";import{d as _s}from"./prosemirror-dropcursor-HUb11Unb.js";import{g as Ls}from"./prosemirror-gapcursor-CHFTFkqk.js";import{u as Rs,r as Ps,h as Ns}from"./prosemirror-history-BjKgugDr.js";import{k as Is}from"./prosemirror-keymap-BAKRQlar.js";import{F as ue,S as $s,N as Hs,a as bn,D as st,b as Ds}from"./prosemirror-model-CWJw0FAp.js";import{f as Bs,c as bt,T as js,l as Fs,j as wn,a as Fe,R as zs,b as Us}from"./prosemirror-transform-CmxhxSzP.js";import{c as Ws,d as Ks,e as Vs,j as qs,a as Gs,b as Qs,f as Js,g as Ys,h as Xs,l as Zs,i as er,n as tr,s as nr,k as sr,m as rr,o as ir,p as or,q as zt,w as ar}from"./prosemirror-commands-B0Mmz6rZ.js";import{l as lr,s as ur,w as cr}from"./prosemirror-schema-list-DpEpyLDh.js";function qe(e){const{state:t,transaction:n}=e;let{selection:s}=n,{doc:r}=n,{storedMarks:i}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return i},get selection(){return s},get doc(){return r},get tr(){return s=n.selection,r=n.doc,i=n.storedMarks,n}}}class Ge{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:n,state:s}=this,{view:r}=n,{tr:i}=s,o=this.buildProps(i);return Object.fromEntries(Object.entries(t).map(([a,l])=>[a,(...d)=>{const c=l(...d)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(i),c}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,n=!0){const{rawCommands:s,editor:r,state:i}=this,{view:o}=r,a=[],l=!!t,u=t||i.tr,d=()=>(!l&&n&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(u),a.every(f=>f===!0)),c={...Object.fromEntries(Object.entries(s).map(([f,p])=>[f,(...h)=>{const y=this.buildProps(u,n),g=p(...h)(y);return a.push(g),c}])),run:d};return c}createCan(t){const{rawCommands:n,state:s}=this,r=!1,i=t||s.tr,o=this.buildProps(i,r);return{...Object.fromEntries(Object.entries(n).map(([l,u])=>[l,(...d)=>u(...d)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,r)}}buildProps(t,n=!0){const{rawCommands:s,editor:r,state:i}=this,{view:o}=r,a={tr:t,editor:r,view:o,state:qe({state:i,transaction:t}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(t,n),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(s).map(([l,u])=>[l,(...d)=>u(...d)(a)]))}};return a}}class dr{constructor(){this.callbacks={}}on(t,n){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(n),this}emit(t,...n){const s=this.callbacks[t];return s&&s.forEach(r=>r.apply(this,n)),this}off(t,n){const s=this.callbacks[t];return s&&(n?this.callbacks[t]=s.filter(r=>r!==n):delete this.callbacks[t]),this}once(t,n){const s=(...r)=>{this.off(t,s),n.apply(this,r)};return this.on(t,s)}removeAllListeners(){this.callbacks={}}}function E(e,t,n){return e.config[t]===void 0&&e.parent?E(e.parent,t,n):typeof e.config[t]=="function"?e.config[t].bind({...n,parent:e.parent?E(e.parent,t,n):null}):e.config[t]}function Qe(e){const t=e.filter(r=>r.type==="extension"),n=e.filter(r=>r.type==="node"),s=e.filter(r=>r.type==="mark");return{baseExtensions:t,nodeExtensions:n,markExtensions:s}}function Mn(e){const t=[],{nodeExtensions:n,markExtensions:s}=Qe(e),r=[...n,...s],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage,extensions:r},l=E(o,"addGlobalAttributes",a);if(!l)return;l().forEach(d=>{d.types.forEach(c=>{Object.entries(d.attributes).forEach(([f,p])=>{t.push({type:c,name:f,attribute:{...i,...p}})})})})}),r.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=E(o,"addAttributes",a);if(!l)return;const u=l();Object.entries(u).forEach(([d,c])=>{const f={...i,...c};typeof(f==null?void 0:f.default)=="function"&&(f.default=f.default()),f!=null&&f.isRequired&&(f==null?void 0:f.default)===void 0&&delete f.default,t.push({type:o.name,name:d,attribute:f})})}),t}function W(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function I(...e){return e.filter(t=>!!t).reduce((t,n)=>{const s={...t};return Object.entries(n).forEach(([r,i])=>{if(!s[r]){s[r]=i;return}if(r==="class"){const a=i?String(i).split(" "):[],l=s[r]?s[r].split(" "):[],u=a.filter(d=>!l.includes(d));s[r]=[...l,...u].join(" ")}else if(r==="style"){const a=i?i.split(";").map(d=>d.trim()).filter(Boolean):[],l=s[r]?s[r].split(";").map(d=>d.trim()).filter(Boolean):[],u=new Map;l.forEach(d=>{const[c,f]=d.split(":").map(p=>p.trim());u.set(c,f)}),a.forEach(d=>{const[c,f]=d.split(":").map(p=>p.trim());u.set(c,f)}),s[r]=Array.from(u.entries()).map(([d,c])=>`${d}: ${c}`).join("; ")}else s[r]=i}),s},{})}function Ue(e,t){return t.filter(n=>n.type===e.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(e.attrs)||{}:{[n.name]:e.attrs[n.name]}).reduce((n,s)=>I(n,s),{})}function En(e){return typeof e=="function"}function O(e,t=void 0,...n){return En(e)?t?e.bind(t)(...n):e(...n):e}function fr(e={}){return Object.keys(e).length===0&&e.constructor===Object}function pr(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function Ut(e,t){return"style"in e?e:{...e,getAttrs:n=>{const s=e.getAttrs?e.getAttrs(n):e.attrs;if(s===!1)return!1;const r=t.reduce((i,o)=>{const a=o.attribute.parseHTML?o.attribute.parseHTML(n):pr(n.getAttribute(o.name));return a==null?i:{...i,[o.name]:a}},{});return{...s,...r}}}}function Wt(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>t==="attrs"&&fr(n)?!1:n!=null))}function hr(e,t){var n;const s=Mn(e),{nodeExtensions:r,markExtensions:i}=Qe(e),o=(n=r.find(u=>E(u,"topNode")))===null||n===void 0?void 0:n.name,a=Object.fromEntries(r.map(u=>{const d=s.filter(g=>g.type===u.name),c={name:u.name,options:u.options,storage:u.storage,editor:t},f=e.reduce((g,w)=>{const S=E(w,"extendNodeSchema",c);return{...g,...S?S(u):{}}},{}),p=Wt({...f,content:O(E(u,"content",c)),marks:O(E(u,"marks",c)),group:O(E(u,"group",c)),inline:O(E(u,"inline",c)),atom:O(E(u,"atom",c)),selectable:O(E(u,"selectable",c)),draggable:O(E(u,"draggable",c)),code:O(E(u,"code",c)),whitespace:O(E(u,"whitespace",c)),linebreakReplacement:O(E(u,"linebreakReplacement",c)),defining:O(E(u,"defining",c)),isolating:O(E(u,"isolating",c)),attrs:Object.fromEntries(d.map(g=>{var w;return[g.name,{default:(w=g==null?void 0:g.attribute)===null||w===void 0?void 0:w.default}]}))}),m=O(E(u,"parseHTML",c));m&&(p.parseDOM=m.map(g=>Ut(g,d)));const h=E(u,"renderHTML",c);h&&(p.toDOM=g=>h({node:g,HTMLAttributes:Ue(g,d)}));const y=E(u,"renderText",c);return y&&(p.toText=y),[u.name,p]})),l=Object.fromEntries(i.map(u=>{const d=s.filter(y=>y.type===u.name),c={name:u.name,options:u.options,storage:u.storage,editor:t},f=e.reduce((y,g)=>{const w=E(g,"extendMarkSchema",c);return{...y,...w?w(u):{}}},{}),p=Wt({...f,inclusive:O(E(u,"inclusive",c)),excludes:O(E(u,"excludes",c)),group:O(E(u,"group",c)),spanning:O(E(u,"spanning",c)),code:O(E(u,"code",c)),attrs:Object.fromEntries(d.map(y=>{var g;return[y.name,{default:(g=y==null?void 0:y.attribute)===null||g===void 0?void 0:g.default}]}))}),m=O(E(u,"parseHTML",c));m&&(p.parseDOM=m.map(y=>Ut(y,d)));const h=E(u,"renderHTML",c);return h&&(p.toDOM=y=>h({mark:y,HTMLAttributes:Ue(y,d)})),[u.name,p]}));return new bn({topNode:o,nodes:a,marks:l})}function rt(e,t){return t.nodes[e]||t.marks[e]||null}function Kt(e,t){return Array.isArray(t)?t.some(n=>(typeof n=="string"?n:n.name)===e.name):t}function wt(e,t){const n=Ds.fromSchema(t).serializeFragment(e),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}const mr=(e,t=500)=>{let n="";const s=e.parentOffset;return e.parent.nodesBetween(Math.max(0,s-t),s,(r,i,o,a)=>{var l,u;const d=((u=(l=r.type.spec).toText)===null||u===void 0?void 0:u.call(l,{node:r,pos:i,parent:o,index:a}))||r.textContent||"%leaf%";n+=r.isAtom&&!r.isText?d:d.slice(0,Math.max(0,s-i))}),n};function Mt(e){return Object.prototype.toString.call(e)==="[object RegExp]"}class Oe{constructor(t){this.find=t.find,this.handler=t.handler}}const gr=(e,t)=>{if(Mt(t))return t.exec(e);const n=t(e);if(!n)return null;const s=[n.text];return s.index=n.index,s.input=e,s.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),s.push(n.replaceWith)),s};function Ie(e){var t;const{editor:n,from:s,to:r,text:i,rules:o,plugin:a}=e,{view:l}=n;if(l.composing)return!1;const u=l.state.doc.resolve(s);if(u.parent.type.spec.code||!((t=u.nodeBefore||u.nodeAfter)===null||t===void 0)&&t.marks.find(f=>f.type.spec.code))return!1;let d=!1;const c=mr(u)+i;return o.forEach(f=>{if(d)return;const p=gr(c,f.find);if(!p)return;const m=l.state.tr,h=qe({state:l.state,transaction:m}),y={from:s-(p[0].length-i.length),to:r},{commands:g,chain:w,can:S}=new Ge({editor:n,state:h});f.handler({state:h,range:y,match:p,commands:g,chain:w,can:S})===null||!m.steps.length||(m.setMeta(a,{transform:m,from:s,to:r,text:i}),l.dispatch(m),d=!0)}),d}function yr(e){const{editor:t,rules:n}=e,s=new K({state:{init(){return null},apply(r,i,o){const a=r.getMeta(s);if(a)return a;const l=r.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:d}=l;typeof d=="string"?d=d:d=wt(ue.from(d),o.schema);const{from:c}=l,f=c+d.length;Ie({editor:t,from:c,to:f,text:d,rules:n,plugin:s})}),r.selectionSet||r.docChanged?null:i}},props:{handleTextInput(r,i,o,a){return Ie({editor:t,from:i,to:o,text:a,rules:n,plugin:s})},handleDOMEvents:{compositionend:r=>(setTimeout(()=>{const{$cursor:i}=r.state.selection;i&&Ie({editor:t,from:i.pos,to:i.pos,text:"",rules:n,plugin:s})}),!1)},handleKeyDown(r,i){if(i.key!=="Enter")return!1;const{$cursor:o}=r.state.selection;return o?Ie({editor:t,from:o.pos,to:o.pos,text:`
`,rules:n,plugin:s}):!1}},isInputRules:!0});return s}function br(e){return Object.prototype.toString.call(e).slice(8,-1)}function $e(e){return br(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function Je(e,t){const n={...e};return $e(e)&&$e(t)&&Object.keys(t).forEach(s=>{$e(t[s])&&$e(e[s])?n[s]=Je(e[s],t[s]):n[s]=t[s]}),n}class ne{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=O(E(this,"addOptions",{name:this.name}))),this.storage=O(E(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new ne(t)}configure(t={}){const n=this.extend({...this.config,addOptions:()=>Je(this.options,t)});return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new ne(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=O(E(n,"addOptions",{name:n.name})),n.storage=O(E(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:t,mark:n}){const{tr:s}=t.state,r=t.state.selection.$from;if(r.pos===r.end()){const o=r.marks();if(!!!o.find(u=>(u==null?void 0:u.type.name)===n.name))return!1;const l=o.find(u=>(u==null?void 0:u.type.name)===n.name);return l&&s.removeStoredMark(l),s.insertText(" ",r.pos),t.view.dispatch(s),!0}return!1}}function wr(e){return typeof e=="number"}class kn{constructor(t){this.find=t.find,this.handler=t.handler}}const Mr=(e,t,n)=>{if(Mt(t))return[...e.matchAll(t)];const s=t(e,n);return s?s.map(r=>{const i=[r.text];return i.index=r.index,i.input=e,i.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(r.replaceWith)),i}):[]};function Er(e){const{editor:t,state:n,from:s,to:r,rule:i,pasteEvent:o,dropEvent:a}=e,{commands:l,chain:u,can:d}=new Ge({editor:t,state:n}),c=[];return n.doc.nodesBetween(s,r,(p,m)=>{if(!p.isTextblock||p.type.spec.code)return;const h=Math.max(s,m),y=Math.min(r,m+p.content.size),g=p.textBetween(h-m,y-m,void 0,"￼");Mr(g,i.find,o).forEach(S=>{if(S.index===void 0)return;const C=h+S.index+1,L=C+S[0].length,k={from:n.tr.mapping.map(C),to:n.tr.mapping.map(L)},R=i.handler({state:n,range:k,match:S,commands:l,chain:u,can:d,pasteEvent:o,dropEvent:a});c.push(R)})}),c.every(p=>p!==null)}let He=null;const kr=e=>{var t;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=n.clipboardData)===null||t===void 0||t.setData("text/html",e),n};function Sr(e){const{editor:t,rules:n}=e;let s=null,r=!1,i=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:d,from:c,to:f,rule:p,pasteEvt:m})=>{const h=d.tr,y=qe({state:d,transaction:h});if(!(!Er({editor:t,state:y,from:Math.max(c-1,0),to:f.b-1,rule:p,pasteEvent:m,dropEvent:a})||!h.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,h}};return n.map(d=>new K({view(c){const f=m=>{var h;s=!((h=c.dom.parentElement)===null||h===void 0)&&h.contains(m.target)?c.dom.parentElement:null,s&&(He=t)},p=()=>{He&&(He=null)};return window.addEventListener("dragstart",f),window.addEventListener("dragend",p),{destroy(){window.removeEventListener("dragstart",f),window.removeEventListener("dragend",p)}}},props:{handleDOMEvents:{drop:(c,f)=>{if(i=s===c.dom.parentElement,a=f,!i){const p=He;p&&setTimeout(()=>{const m=p.state.selection;m&&p.commands.deleteRange({from:m.from,to:m.to})},10)}return!1},paste:(c,f)=>{var p;const m=(p=f.clipboardData)===null||p===void 0?void 0:p.getData("text/html");return o=f,r=!!(m!=null&&m.includes("data-pm-slice")),!1}}},appendTransaction:(c,f,p)=>{const m=c[0],h=m.getMeta("uiEvent")==="paste"&&!r,y=m.getMeta("uiEvent")==="drop"&&!i,g=m.getMeta("applyPasteRules"),w=!!g;if(!h&&!y&&!w)return;if(w){let{text:L}=g;typeof L=="string"?L=L:L=wt(ue.from(L),p.schema);const{from:k}=g,R=k+L.length,F=kr(L);return l({rule:d,state:p,from:k,to:{b:R},pasteEvt:F})}const S=f.doc.content.findDiffStart(p.doc.content),C=f.doc.content.findDiffEnd(p.doc.content);if(!(!wr(S)||!C||S===C.b))return l({rule:d,state:p,from:S,to:C,pasteEvt:o})}}))}function xr(e){const t=e.filter((n,s)=>e.indexOf(n)!==s);return Array.from(new Set(t))}class Ee{constructor(t,n){this.splittableMarks=[],this.editor=n,this.extensions=Ee.resolve(t),this.schema=hr(this.extensions,n),this.setupExtensions()}static resolve(t){const n=Ee.sort(Ee.flatten(t)),s=xr(n.map(r=>r.name));return s.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${s.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),n}static flatten(t){return t.map(n=>{const s={name:n.name,options:n.options,storage:n.storage},r=E(n,"addExtensions",s);return r?[n,...this.flatten(r())]:n}).flat(10)}static sort(t){return t.sort((s,r)=>{const i=E(s,"priority")||100,o=E(r,"priority")||100;return i>o?-1:i<o?1:0})}get commands(){return this.extensions.reduce((t,n)=>{const s={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:rt(n.name,this.schema)},r=E(n,"addCommands",s);return r?{...t,...r()}:t},{})}get plugins(){const{editor:t}=this,n=Ee.sort([...this.extensions].reverse()),s=[],r=[],i=n.map(o=>{const a={name:o.name,options:o.options,storage:o.storage,editor:t,type:rt(o.name,this.schema)},l=[],u=E(o,"addKeyboardShortcuts",a);let d={};if(o.type==="mark"&&E(o,"exitable",a)&&(d.ArrowRight=()=>ne.handleExit({editor:t,mark:o})),u){const h=Object.fromEntries(Object.entries(u()).map(([y,g])=>[y,()=>g({editor:t})]));d={...d,...h}}const c=Is(d);l.push(c);const f=E(o,"addInputRules",a);Kt(o,t.options.enableInputRules)&&f&&s.push(...f());const p=E(o,"addPasteRules",a);Kt(o,t.options.enablePasteRules)&&p&&r.push(...p());const m=E(o,"addProseMirrorPlugins",a);if(m){const h=m();l.push(...h)}return l}).flat();return[yr({editor:t,rules:s}),...Sr({editor:t,rules:r}),...i]}get attributes(){return Mn(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:n}=Qe(this.extensions);return Object.fromEntries(n.filter(s=>!!E(s,"addNodeView")).map(s=>{const r=this.attributes.filter(l=>l.type===s.name),i={name:s.name,options:s.options,storage:s.storage,editor:t,type:W(s.name,this.schema)},o=E(s,"addNodeView",i);if(!o)return[];const a=(l,u,d,c,f)=>{const p=Ue(l,r);return o()({node:l,view:u,getPos:d,decorations:c,innerDecorations:f,editor:t,extension:s,HTMLAttributes:p})};return[s.name,a]}))}setupExtensions(){this.extensions.forEach(t=>{var n;this.editor.extensionStorage[t.name]=t.storage;const s={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:rt(t.name,this.schema)};t.type==="mark"&&(!((n=O(E(t,"keepOnSplit",s)))!==null&&n!==void 0)||n)&&this.splittableMarks.push(t.name);const r=E(t,"onBeforeCreate",s),i=E(t,"onCreate",s),o=E(t,"onUpdate",s),a=E(t,"onSelectionUpdate",s),l=E(t,"onTransaction",s),u=E(t,"onFocus",s),d=E(t,"onBlur",s),c=E(t,"onDestroy",s);r&&this.editor.on("beforeCreate",r),i&&this.editor.on("create",i),o&&this.editor.on("update",o),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),u&&this.editor.on("focus",u),d&&this.editor.on("blur",d),c&&this.editor.on("destroy",c)})}}class z{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=O(E(this,"addOptions",{name:this.name}))),this.storage=O(E(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new z(t)}configure(t={}){const n=this.extend({...this.config,addOptions:()=>Je(this.options,t)});return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new z({...this.config,...t});return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=O(E(n,"addOptions",{name:n.name})),n.storage=O(E(n,"addStorage",{name:n.name,options:n.options})),n}}function Sn(e,t,n){const{from:s,to:r}=t,{blockSeparator:i=`

`,textSerializers:o={}}=n||{};let a="";return e.nodesBetween(s,r,(l,u,d,c)=>{var f;l.isBlock&&u>s&&(a+=i);const p=o==null?void 0:o[l.type.name];if(p)return d&&(a+=p({node:l,pos:u,parent:d,index:c,range:t})),!1;l.isText&&(a+=(f=l==null?void 0:l.text)===null||f===void 0?void 0:f.slice(Math.max(s,u)-u,r-u))}),a}function Et(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,n])=>[t,n.spec.toText]))}const Tr=z.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new K({key:new Q("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:s,selection:r}=t,{ranges:i}=r,o=Math.min(...i.map(d=>d.$from.pos)),a=Math.max(...i.map(d=>d.$to.pos)),l=Et(n);return Sn(s,{from:o,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),Cr=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),vr=(e=!1)=>({commands:t})=>t.setContent("",e),Ar=()=>({state:e,tr:t,dispatch:n})=>{const{selection:s}=t,{ranges:r}=s;return n&&r.forEach(({$from:i,$to:o})=>{e.doc.nodesBetween(i.pos,o.pos,(a,l)=>{if(a.type.isText)return;const{doc:u,mapping:d}=t,c=u.resolve(d.map(l)),f=u.resolve(d.map(l+a.nodeSize)),p=c.blockRange(f);if(!p)return;const m=Fs(p);if(a.type.isTextblock){const{defaultType:h}=c.parent.contentMatchAt(c.index());t.setNodeMarkup(p.start,h)}(m||m===0)&&t.lift(p,m)})}),!0},Or=e=>t=>e(t),_r=()=>({state:e,dispatch:t})=>Ws(e,t),Lr=(e,t)=>({editor:n,tr:s})=>{const{state:r}=n,i=r.doc.slice(e.from,e.to);s.deleteRange(e.from,e.to);const o=s.mapping.map(t);return s.insert(o,i.content),s.setSelection(new X(s.doc.resolve(o-1))),!0},Rr=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,s=n.$anchor.node();if(s.content.size>0)return!1;const r=e.selection.$anchor;for(let i=r.depth;i>0;i-=1)if(r.node(i).type===s.type){if(t){const a=r.before(i),l=r.after(i);e.delete(a,l).scrollIntoView()}return!0}return!1},Pr=e=>({tr:t,state:n,dispatch:s})=>{const r=W(e,n.schema),i=t.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r){if(s){const l=i.before(o),u=i.after(o);t.delete(l,u).scrollIntoView()}return!0}return!1},Nr=e=>({tr:t,dispatch:n})=>{const{from:s,to:r}=e;return n&&t.delete(s,r),!0},Ir=()=>({state:e,dispatch:t})=>Ks(e,t),$r=()=>({commands:e})=>e.keyboardShortcut("Enter"),Hr=()=>({state:e,dispatch:t})=>Vs(e,t);function We(e,t,n={strict:!0}){const s=Object.keys(t);return s.length?s.every(r=>n.strict?t[r]===e[r]:Mt(t[r])?t[r].test(e[r]):t[r]===e[r]):!0}function xn(e,t,n={}){return e.find(s=>s.type===t&&We(Object.fromEntries(Object.keys(n).map(r=>[r,s.attrs[r]])),n))}function Vt(e,t,n={}){return!!xn(e,t,n)}function kt(e,t,n){var s;if(!e||!t)return;let r=e.parent.childAfter(e.parentOffset);if((!r.node||!r.node.marks.some(d=>d.type===t))&&(r=e.parent.childBefore(e.parentOffset)),!r.node||!r.node.marks.some(d=>d.type===t)||(n=n||((s=r.node.marks[0])===null||s===void 0?void 0:s.attrs),!xn([...r.node.marks],t,n)))return;let o=r.index,a=e.start()+r.offset,l=o+1,u=a+r.node.nodeSize;for(;o>0&&Vt([...e.parent.child(o-1).marks],t,n);)o-=1,a-=e.parent.child(o).nodeSize;for(;l<e.parent.childCount&&Vt([...e.parent.child(l).marks],t,n);)u+=e.parent.child(l).nodeSize,l+=1;return{from:a,to:u}}function ce(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}const Dr=(e,t={})=>({tr:n,state:s,dispatch:r})=>{const i=ce(e,s.schema),{doc:o,selection:a}=n,{$from:l,from:u,to:d}=a;if(r){const c=kt(l,i,t);if(c&&c.from<=u&&c.to>=d){const f=X.create(o,c.from,c.to);n.setSelection(f)}}return!0},Br=e=>t=>{const n=typeof e=="function"?e(t):e;for(let s=0;s<n.length;s+=1)if(n[s](t))return!0;return!1};function St(e){return e instanceof X}function oe(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function Tn(e,t=null){if(!t)return null;const n=ge.atStart(e),s=ge.atEnd(e);if(t==="start"||t===!0)return n;if(t==="end")return s;const r=n.from,i=s.to;return t==="all"?X.create(e,oe(0,r,i),oe(e.content.size,r,i)):X.create(e,oe(t,r,i),oe(t,r,i))}const jr=(e=null,t={})=>({editor:n,view:s,tr:r,dispatch:i})=>{t={scrollIntoView:!0,...t};const o=()=>{s.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(s.focus(),t!=null&&t.scrollIntoView&&n.commands.scrollIntoView())})};if(s.hasFocus()&&e===null||e===!1)return!0;if(i&&e===null&&!St(n.state.selection))return o(),!0;const a=Tn(r.doc,e)||n.state.selection,l=n.state.selection.eq(a);return i&&(l||r.setSelection(a),l&&r.storedMarks&&r.setStoredMarks(r.storedMarks),o()),!0},Fr=(e,t)=>n=>e.every((s,r)=>t(s,{...n,index:r})),zr=(e,t)=>({tr:n,commands:s})=>s.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),Cn=e=>{const t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){const s=t[n];s.nodeType===3&&s.nodeValue&&/^(\n\s\s|\n)$/.test(s.nodeValue)?e.removeChild(s):s.nodeType===1&&Cn(s)}return e};function De(e){const t=`<body>${e}</body>`,n=new window.DOMParser().parseFromString(t,"text/html").body;return Cn(n)}function Ke(e,t,n){if(e instanceof Hs||e instanceof ue)return e;n={slice:!0,parseOptions:{},...n};const s=typeof e=="object"&&e!==null,r=typeof e=="string";if(s)try{if(Array.isArray(e)&&e.length>0)return ue.fromArray(e.map(a=>t.nodeFromJSON(a)));const o=t.nodeFromJSON(e);return n.errorOnInvalidContent&&o.check(),o}catch(i){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:i});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",i),Ke("",t,n)}if(r){if(n.errorOnInvalidContent){let o=!1,a="";const l=new bn({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(o=!0,a=typeof u=="string"?u:u.outerHTML,null)}]}})});if(n.slice?st.fromSchema(l).parseSlice(De(e),n.parseOptions):st.fromSchema(l).parse(De(e),n.parseOptions),n.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const i=st.fromSchema(t);return n.slice?i.parseSlice(De(e),n.parseOptions).content:i.parse(De(e),n.parseOptions)}return Ke("",t,n)}function Ur(e,t,n){const s=e.steps.length-1;if(s<t)return;const r=e.steps[s];if(!(r instanceof zs||r instanceof Us))return;const i=e.mapping.maps[s];let o=0;i.forEach((a,l,u,d)=>{o===0&&(o=d)}),e.setSelection(ge.near(e.doc.resolve(o),n))}const Wr=e=>!("type"in e),Kr=(e,t,n)=>({tr:s,dispatch:r,editor:i})=>{var o;if(r){n={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let a;try{a=Ke(t,i.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions},errorOnInvalidContent:(o=n.errorOnInvalidContent)!==null&&o!==void 0?o:i.options.enableContentCheck})}catch(m){return i.emit("contentError",{editor:i,error:m,disableCollaboration:()=>{i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}}),!1}let{from:l,to:u}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},d=!0,c=!0;if((Wr(a)?a:[a]).forEach(m=>{m.check(),d=d?m.isText&&m.marks.length===0:!1,c=c?m.isBlock:!1}),l===u&&c){const{parent:m}=s.doc.resolve(l);m.isTextblock&&!m.type.spec.code&&!m.childCount&&(l-=1,u+=1)}let p;if(d){if(Array.isArray(t))p=t.map(m=>m.text||"").join("");else if(t instanceof ue){let m="";t.forEach(h=>{h.text&&(m+=h.text)}),p=m}else typeof t=="object"&&t&&t.text?p=t.text:p=t;s.insertText(p,l,u)}else p=a,s.replaceWith(l,u,p);n.updateSelection&&Ur(s,s.steps.length-1,-1),n.applyInputRules&&s.setMeta("applyInputRules",{from:l,text:p}),n.applyPasteRules&&s.setMeta("applyPasteRules",{from:l,text:p})}return!0},Vr=()=>({state:e,dispatch:t})=>qs(e,t),qr=()=>({state:e,dispatch:t})=>Gs(e,t),Gr=()=>({state:e,dispatch:t})=>Qs(e,t),Qr=()=>({state:e,dispatch:t})=>Js(e,t),Jr=()=>({state:e,dispatch:t,tr:n})=>{try{const s=wn(e.doc,e.selection.$from.pos,-1);return s==null?!1:(n.join(s,2),t&&t(n),!0)}catch{return!1}},Yr=()=>({state:e,dispatch:t,tr:n})=>{try{const s=wn(e.doc,e.selection.$from.pos,1);return s==null?!1:(n.join(s,2),t&&t(n),!0)}catch{return!1}},Xr=()=>({state:e,dispatch:t})=>Ys(e,t),Zr=()=>({state:e,dispatch:t})=>Xs(e,t);function xt(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function vn(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function ei(e){const t=e.split(/-(?!$)/);let n=t[t.length-1];n==="Space"&&(n=" ");let s,r,i,o;for(let a=0;a<t.length-1;a+=1){const l=t[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))s=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))xt()||vn()?o=!0:r=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return s&&(n=`Alt-${n}`),r&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),i&&(n=`Shift-${n}`),n}const ti=e=>({editor:t,view:n,tr:s,dispatch:r})=>{const i=ei(e).split(/-(?!$)/),o=i.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),a=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{n.someProp("handleKeyDown",u=>u(n,a))});return l==null||l.steps.forEach(u=>{const d=u.map(s.mapping);d&&r&&s.maybeStep(d)}),!0};function Te(e,t,n={}){const{from:s,to:r,empty:i}=e.selection,o=t?W(t,e.schema):null,a=[];e.doc.nodesBetween(s,r,(c,f)=>{if(c.isText)return;const p=Math.max(s,f),m=Math.min(r,f+c.nodeSize);a.push({node:c,from:p,to:m})});const l=r-s,u=a.filter(c=>o?o.name===c.node.type.name:!0).filter(c=>We(c.node.attrs,n,{strict:!1}));return i?!!u.length:u.reduce((c,f)=>c+f.to-f.from,0)>=l}const ni=(e,t={})=>({state:n,dispatch:s})=>{const r=W(e,n.schema);return Te(n,r,t)?Zs(n,s):!1},si=()=>({state:e,dispatch:t})=>er(e,t),ri=e=>({state:t,dispatch:n})=>{const s=W(e,t.schema);return lr(s)(t,n)},ii=()=>({state:e,dispatch:t})=>tr(e,t);function Ye(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function qt(e,t){const n=typeof t=="string"?[t]:t;return Object.keys(e).reduce((s,r)=>(n.includes(r)||(s[r]=e[r]),s),{})}const oi=(e,t)=>({tr:n,state:s,dispatch:r})=>{let i=null,o=null;const a=Ye(typeof e=="string"?e:e.name,s.schema);return a?(a==="node"&&(i=W(e,s.schema)),a==="mark"&&(o=ce(e,s.schema)),r&&n.selection.ranges.forEach(l=>{s.doc.nodesBetween(l.$from.pos,l.$to.pos,(u,d)=>{i&&i===u.type&&n.setNodeMarkup(d,void 0,qt(u.attrs,t)),o&&u.marks.length&&u.marks.forEach(c=>{o===c.type&&n.addMark(d,d+u.nodeSize,o.create(qt(c.attrs,t)))})})}),!0):!1},ai=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),li=()=>({tr:e,dispatch:t})=>{if(t){const n=new ds(e.doc);e.setSelection(n)}return!0},ui=()=>({state:e,dispatch:t})=>nr(e,t),ci=()=>({state:e,dispatch:t})=>sr(e,t),di=()=>({state:e,dispatch:t})=>rr(e,t),fi=()=>({state:e,dispatch:t})=>ir(e,t),pi=()=>({state:e,dispatch:t})=>or(e,t);function ct(e,t,n={},s={}){return Ke(e,t,{slice:!1,parseOptions:n,errorOnInvalidContent:s.errorOnInvalidContent})}const hi=(e,t=!1,n={},s={})=>({editor:r,tr:i,dispatch:o,commands:a})=>{var l,u;const{doc:d}=i;if(n.preserveWhitespace!=="full"){const c=ct(e,r.schema,n,{errorOnInvalidContent:(l=s.errorOnInvalidContent)!==null&&l!==void 0?l:r.options.enableContentCheck});return o&&i.replaceWith(0,d.content.size,c).setMeta("preventUpdate",!t),!0}return o&&i.setMeta("preventUpdate",!t),a.insertContentAt({from:0,to:d.content.size},e,{parseOptions:n,errorOnInvalidContent:(u=s.errorOnInvalidContent)!==null&&u!==void 0?u:r.options.enableContentCheck})};function An(e,t){const n=ce(t,e.schema),{from:s,to:r,empty:i}=e.selection,o=[];i?(e.storedMarks&&o.push(...e.storedMarks),o.push(...e.selection.$head.marks())):e.doc.nodesBetween(s,r,l=>{o.push(...l.marks)});const a=o.find(l=>l.type.name===n.name);return a?{...a.attrs}:{}}function mi(e,t){const n=new js(e);return t.forEach(s=>{s.steps.forEach(r=>{n.step(r)})}),n}function gi(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function dt(e,t){const n=[];return e.descendants((s,r)=>{t(s)&&n.push({node:s,pos:r})}),n}function yi(e,t,n){const s=[];return e.nodesBetween(t.from,t.to,(r,i)=>{n(r)&&s.push({node:r,pos:i})}),s}function On(e,t){for(let n=e.depth;n>0;n-=1){const s=e.node(n);if(t(s))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:s}}}function Tt(e){return t=>On(t.$from,e)}function _n(e,t){const n={from:0,to:e.content.size};return Sn(e,n,t)}function bi(e,t){const n=W(t,e.schema),{from:s,to:r}=e.selection,i=[];e.doc.nodesBetween(s,r,a=>{i.push(a)});const o=i.reverse().find(a=>a.type.name===n.name);return o?{...o.attrs}:{}}function Ln(e,t){const n=Ye(typeof t=="string"?t:t.name,e.schema);return n==="node"?bi(e,t):n==="mark"?An(e,t):{}}function wi(e,t=JSON.stringify){const n={};return e.filter(s=>{const r=t(s);return Object.prototype.hasOwnProperty.call(n,r)?!1:n[r]=!0})}function Mi(e){const t=wi(e);return t.length===1?t:t.filter((n,s)=>!t.filter((i,o)=>o!==s).some(i=>n.oldRange.from>=i.oldRange.from&&n.oldRange.to<=i.oldRange.to&&n.newRange.from>=i.newRange.from&&n.newRange.to<=i.newRange.to))}function Ei(e){const{mapping:t,steps:n}=e,s=[];return t.maps.forEach((r,i)=>{const o=[];if(r.ranges.length)r.forEach((a,l)=>{o.push({from:a,to:l})});else{const{from:a,to:l}=n[i];if(a===void 0||l===void 0)return;o.push({from:a,to:l})}o.forEach(({from:a,to:l})=>{const u=t.slice(i).map(a,-1),d=t.slice(i).map(l),c=t.invert().map(u,-1),f=t.invert().map(d);s.push({oldRange:{from:c,to:f},newRange:{from:u,to:d}})})}),Mi(s)}function Ct(e,t,n){const s=[];return e===t?n.resolve(e).marks().forEach(r=>{const i=n.resolve(e),o=kt(i,r.type);o&&s.push({mark:r,...o})}):n.nodesBetween(e,t,(r,i)=>{!r||(r==null?void 0:r.nodeSize)===void 0||s.push(...r.marks.map(o=>({from:i,to:i+r.nodeSize,mark:o})))}),s}function ze(e,t,n){return Object.fromEntries(Object.entries(n).filter(([s])=>{const r=e.find(i=>i.type===t&&i.name===s);return r?r.attribute.keepOnSplit:!1}))}function ft(e,t,n={}){const{empty:s,ranges:r}=e.selection,i=t?ce(t,e.schema):null;if(s)return!!(e.storedMarks||e.selection.$from.marks()).filter(c=>i?i.name===c.type.name:!0).find(c=>We(c.attrs,n,{strict:!1}));let o=0;const a=[];if(r.forEach(({$from:c,$to:f})=>{const p=c.pos,m=f.pos;e.doc.nodesBetween(p,m,(h,y)=>{if(!h.isText&&!h.marks.length)return;const g=Math.max(p,y),w=Math.min(m,y+h.nodeSize),S=w-g;o+=S,a.push(...h.marks.map(C=>({mark:C,from:g,to:w})))})}),o===0)return!1;const l=a.filter(c=>i?i.name===c.mark.type.name:!0).filter(c=>We(c.mark.attrs,n,{strict:!1})).reduce((c,f)=>c+f.to-f.from,0),u=a.filter(c=>i?c.mark.type!==i&&c.mark.type.excludes(i):!0).reduce((c,f)=>c+f.to-f.from,0);return(l>0?l+u:l)>=o}function ki(e,t,n={}){if(!t)return Te(e,null,n)||ft(e,null,n);const s=Ye(t,e.schema);return s==="node"?Te(e,t,n):s==="mark"?ft(e,t,n):!1}function Gt(e,t){const{nodeExtensions:n}=Qe(t),s=n.find(o=>o.name===e);if(!s)return!1;const r={name:s.name,options:s.options,storage:s.storage},i=O(E(s,"group",r));return typeof i!="string"?!1:i.split(" ").includes("list")}function Xe(e,{checkChildren:t=!0,ignoreWhitespace:n=!1}={}){var s;if(n){if(e.type.name==="hardBreak")return!0;if(e.isText)return/^\s*$/m.test((s=e.text)!==null&&s!==void 0?s:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(e.content.childCount===0)return!0;if(t){let r=!0;return e.content.forEach(i=>{r!==!1&&(Xe(i,{ignoreWhitespace:n,checkChildren:t})||(r=!1))}),r}return!1}function Rn(e){return e instanceof ke}function Pn(e,t,n){const r=e.state.doc.content.size,i=oe(t,0,r),o=oe(n,0,r),a=e.coordsAtPos(i),l=e.coordsAtPos(o,-1),u=Math.min(a.top,l.top),d=Math.max(a.bottom,l.bottom),c=Math.min(a.left,l.left),f=Math.max(a.right,l.right),p=f-c,m=d-u,g={top:u,bottom:d,left:c,right:f,width:p,height:m,x:c,y:u};return{...g,toJSON:()=>g}}function Si(e,t,n){var s;const{selection:r}=t;let i=null;if(St(r)&&(i=r.$cursor),i){const a=(s=e.storedMarks)!==null&&s!==void 0?s:i.marks();return!!n.isInSet(a)||!a.some(l=>l.type.excludes(n))}const{ranges:o}=r;return o.some(({$from:a,$to:l})=>{let u=a.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(n):!1;return e.doc.nodesBetween(a.pos,l.pos,(d,c,f)=>{if(u)return!1;if(d.isInline){const p=!f||f.type.allowsMarkType(n),m=!!n.isInSet(d.marks)||!d.marks.some(h=>h.type.excludes(n));u=p&&m}return!u}),u})}const xi=(e,t={})=>({tr:n,state:s,dispatch:r})=>{const{selection:i}=n,{empty:o,ranges:a}=i,l=ce(e,s.schema);if(r)if(o){const u=An(s,l);n.addStoredMark(l.create({...u,...t}))}else a.forEach(u=>{const d=u.$from.pos,c=u.$to.pos;s.doc.nodesBetween(d,c,(f,p)=>{const m=Math.max(p,d),h=Math.min(p+f.nodeSize,c);f.marks.find(g=>g.type===l)?f.marks.forEach(g=>{l===g.type&&n.addMark(m,h,l.create({...g.attrs,...t}))}):n.addMark(m,h,l.create(t))})});return Si(s,n,l)},Ti=(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),Ci=(e,t={})=>({state:n,dispatch:s,chain:r})=>{const i=W(e,n.schema);let o;return n.selection.$anchor.sameParent(n.selection.$head)&&(o=n.selection.$anchor.parent.attrs),i.isTextblock?r().command(({commands:a})=>zt(i,{...o,...t})(n)?!0:a.clearNodes()).command(({state:a})=>zt(i,{...o,...t})(a,s)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},vi=e=>({tr:t,dispatch:n})=>{if(n){const{doc:s}=t,r=oe(e,0,s.content.size),i=ke.create(s,r);t.setSelection(i)}return!0},Ai=e=>({tr:t,dispatch:n})=>{if(n){const{doc:s}=t,{from:r,to:i}=typeof e=="number"?{from:e,to:e}:e,o=X.atStart(s).from,a=X.atEnd(s).to,l=oe(r,o,a),u=oe(i,o,a),d=X.create(s,l,u);t.setSelection(d)}return!0},Oi=e=>({state:t,dispatch:n})=>{const s=W(e,t.schema);return ur(s)(t,n)};function Qt(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const s=n.filter(r=>t==null?void 0:t.includes(r.type.name));e.tr.ensureMarks(s)}}const _i=({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:s,editor:r})=>{const{selection:i,doc:o}=t,{$from:a,$to:l}=i,u=r.extensionManager.attributes,d=ze(u,a.node().type.name,a.node().attrs);if(i instanceof ke&&i.node.isBlock)return!a.parentOffset||!Fe(o,a.pos)?!1:(s&&(e&&Qt(n,r.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const c=l.parentOffset===l.parent.content.size,f=a.depth===0?void 0:gi(a.node(-1).contentMatchAt(a.indexAfter(-1)));let p=c&&f?[{type:f,attrs:d}]:void 0,m=Fe(t.doc,t.mapping.map(a.pos),1,p);if(!p&&!m&&Fe(t.doc,t.mapping.map(a.pos),1,f?[{type:f}]:void 0)&&(m=!0,p=f?[{type:f,attrs:d}]:void 0),s){if(m&&(i instanceof X&&t.deleteSelection(),t.split(t.mapping.map(a.pos),1,p),f&&!c&&!a.parentOffset&&a.parent.type!==f)){const h=t.mapping.map(a.before()),y=t.doc.resolve(h);a.node(-1).canReplaceWith(y.index(),y.index()+1,f)&&t.setNodeMarkup(t.mapping.map(a.before()),f)}e&&Qt(n,r.extensionManager.splittableMarks),t.scrollIntoView()}return m},Li=(e,t={})=>({tr:n,state:s,dispatch:r,editor:i})=>{var o;const a=W(e,s.schema),{$from:l,$to:u}=s.selection,d=s.selection.node;if(d&&d.isBlock||l.depth<2||!l.sameParent(u))return!1;const c=l.node(-1);if(c.type!==a)return!1;const f=i.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(r){let g=ue.empty;const w=l.index(-1)?1:l.index(-2)?2:3;for(let F=l.depth-w;F>=l.depth-3;F-=1)g=ue.from(l.node(F).copy(g));const S=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,C={...ze(f,l.node().type.name,l.node().attrs),...t},L=((o=a.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(C))||void 0;g=g.append(ue.from(a.createAndFill(null,L)||void 0));const k=l.before(l.depth-(w-1));n.replace(k,l.after(-S),new $s(g,4-w,0));let R=-1;n.doc.nodesBetween(k,n.doc.content.size,(F,V)=>{if(R>-1)return!1;F.isTextblock&&F.content.size===0&&(R=V+1)}),R>-1&&n.setSelection(X.near(n.doc.resolve(R))),n.scrollIntoView()}return!0}const p=u.pos===l.end()?c.contentMatchAt(0).defaultType:null,m={...ze(f,c.type.name,c.attrs),...t},h={...ze(f,l.node().type.name,l.node().attrs),...t};n.delete(l.pos,u.pos);const y=p?[{type:a,attrs:m},{type:p,attrs:h}]:[{type:a,attrs:m}];if(!Fe(n.doc,l.pos,2))return!1;if(r){const{selection:g,storedMarks:w}=s,{splittableMarks:S}=i.extensionManager,C=w||g.$to.parentOffset&&g.$from.marks();if(n.split(l.pos,2,y).scrollIntoView(),!C||!r)return!0;const L=C.filter(k=>S.includes(k.type.name));n.ensureMarks(L)}return!0},it=(e,t)=>{const n=Tt(o=>o.type===t)(e.selection);if(!n)return!0;const s=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(s===void 0)return!0;const r=e.doc.nodeAt(s);return n.node.type===(r==null?void 0:r.type)&&bt(e.doc,n.pos)&&e.join(n.pos),!0},ot=(e,t)=>{const n=Tt(o=>o.type===t)(e.selection);if(!n)return!0;const s=e.doc.resolve(n.start).after(n.depth);if(s===void 0)return!0;const r=e.doc.nodeAt(s);return n.node.type===(r==null?void 0:r.type)&&bt(e.doc,s)&&e.join(s),!0},Ri=(e,t,n,s={})=>({editor:r,tr:i,state:o,dispatch:a,chain:l,commands:u,can:d})=>{const{extensions:c,splittableMarks:f}=r.extensionManager,p=W(e,o.schema),m=W(t,o.schema),{selection:h,storedMarks:y}=o,{$from:g,$to:w}=h,S=g.blockRange(w),C=y||h.$to.parentOffset&&h.$from.marks();if(!S)return!1;const L=Tt(k=>Gt(k.type.name,c))(h);if(S.depth>=1&&L&&S.depth-L.depth<=1){if(L.node.type===p)return u.liftListItem(m);if(Gt(L.node.type.name,c)&&p.validContent(L.node.content)&&a)return l().command(()=>(i.setNodeMarkup(L.pos,p),!0)).command(()=>it(i,p)).command(()=>ot(i,p)).run()}return!n||!C||!a?l().command(()=>d().wrapInList(p,s)?!0:u.clearNodes()).wrapInList(p,s).command(()=>it(i,p)).command(()=>ot(i,p)).run():l().command(()=>{const k=d().wrapInList(p,s),R=C.filter(F=>f.includes(F.type.name));return i.ensureMarks(R),k?!0:u.clearNodes()}).wrapInList(p,s).command(()=>it(i,p)).command(()=>ot(i,p)).run()},Pi=(e,t={},n={})=>({state:s,commands:r})=>{const{extendEmptyMarkRange:i=!1}=n,o=ce(e,s.schema);return ft(s,o,t)?r.unsetMark(o,{extendEmptyMarkRange:i}):r.setMark(o,t)},Ni=(e,t,n={})=>({state:s,commands:r})=>{const i=W(e,s.schema),o=W(t,s.schema),a=Te(s,i,n);let l;return s.selection.$anchor.sameParent(s.selection.$head)&&(l=s.selection.$anchor.parent.attrs),a?r.setNode(o,l):r.setNode(i,{...l,...n})},Ii=(e,t={})=>({state:n,commands:s})=>{const r=W(e,n.schema);return Te(n,r,t)?s.lift(r):s.wrapIn(r,t)},$i=()=>({state:e,dispatch:t})=>{const n=e.plugins;for(let s=0;s<n.length;s+=1){const r=n[s];let i;if(r.spec.isInputRules&&(i=r.getState(e))){if(t){const o=e.tr,a=i.transform;for(let l=a.steps.length-1;l>=0;l-=1)o.step(a.steps[l].invert(a.docs[l]));if(i.text){const l=o.doc.resolve(i.from).marks();o.replaceWith(i.from,i.to,e.schema.text(i.text,l))}else o.delete(i.from,i.to)}return!0}}return!1},Hi=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,{empty:s,ranges:r}=n;return s||t&&r.forEach(i=>{e.removeMark(i.$from.pos,i.$to.pos)}),!0},Di=(e,t={})=>({tr:n,state:s,dispatch:r})=>{var i;const{extendEmptyMarkRange:o=!1}=t,{selection:a}=n,l=ce(e,s.schema),{$from:u,empty:d,ranges:c}=a;if(!r)return!0;if(d&&o){let{from:f,to:p}=a;const m=(i=u.marks().find(y=>y.type===l))===null||i===void 0?void 0:i.attrs,h=kt(u,l,m);h&&(f=h.from,p=h.to),n.removeMark(f,p,l)}else c.forEach(f=>{n.removeMark(f.$from.pos,f.$to.pos,l)});return n.removeStoredMark(l),!0},Bi=(e,t={})=>({tr:n,state:s,dispatch:r})=>{let i=null,o=null;const a=Ye(typeof e=="string"?e:e.name,s.schema);return a?(a==="node"&&(i=W(e,s.schema)),a==="mark"&&(o=ce(e,s.schema)),r&&n.selection.ranges.forEach(l=>{const u=l.$from.pos,d=l.$to.pos;let c,f,p,m;n.selection.empty?s.doc.nodesBetween(u,d,(h,y)=>{i&&i===h.type&&(p=Math.max(y,u),m=Math.min(y+h.nodeSize,d),c=y,f=h)}):s.doc.nodesBetween(u,d,(h,y)=>{y<u&&i&&i===h.type&&(p=Math.max(y,u),m=Math.min(y+h.nodeSize,d),c=y,f=h),y>=u&&y<=d&&(i&&i===h.type&&n.setNodeMarkup(y,void 0,{...h.attrs,...t}),o&&h.marks.length&&h.marks.forEach(g=>{if(o===g.type){const w=Math.max(y,u),S=Math.min(y+h.nodeSize,d);n.addMark(w,S,o.create({...g.attrs,...t}))}}))}),f&&(c!==void 0&&n.setNodeMarkup(c,void 0,{...f.attrs,...t}),o&&f.marks.length&&f.marks.forEach(h=>{o===h.type&&n.addMark(p,m,o.create({...h.attrs,...t}))}))}),!0):!1},ji=(e,t={})=>({state:n,dispatch:s})=>{const r=W(e,n.schema);return ar(r,t)(n,s)},Fi=(e,t={})=>({state:n,dispatch:s})=>{const r=W(e,n.schema);return cr(r,t)(n,s)};var zi=Object.freeze({__proto__:null,blur:Cr,clearContent:vr,clearNodes:Ar,command:Or,createParagraphNear:_r,cut:Lr,deleteCurrentNode:Rr,deleteNode:Pr,deleteRange:Nr,deleteSelection:Ir,enter:$r,exitCode:Hr,extendMarkRange:Dr,first:Br,focus:jr,forEach:Fr,insertContent:zr,insertContentAt:Kr,joinBackward:Gr,joinDown:qr,joinForward:Qr,joinItemBackward:Jr,joinItemForward:Yr,joinTextblockBackward:Xr,joinTextblockForward:Zr,joinUp:Vr,keyboardShortcut:ti,lift:ni,liftEmptyBlock:si,liftListItem:ri,newlineInCode:ii,resetAttributes:oi,scrollIntoView:ai,selectAll:li,selectNodeBackward:ui,selectNodeForward:ci,selectParentNode:di,selectTextblockEnd:fi,selectTextblockStart:pi,setContent:hi,setMark:xi,setMeta:Ti,setNode:Ci,setNodeSelection:vi,setTextSelection:Ai,sinkListItem:Oi,splitBlock:_i,splitListItem:Li,toggleList:Ri,toggleMark:Pi,toggleNode:Ni,toggleWrap:Ii,undoInputRule:$i,unsetAllMarks:Hi,unsetMark:Di,updateAttributes:Bi,wrapIn:ji,wrapInList:Fi});const Ui=z.create({name:"commands",addCommands(){return{...zi}}}),Wi=z.create({name:"drop",addProseMirrorPlugins(){return[new K({key:new Q("tiptapDrop"),props:{handleDrop:(e,t,n,s)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:n,moved:s})}}})]}}),Ki=z.create({name:"editable",addProseMirrorPlugins(){return[new K({key:new Q("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Vi=z.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new K({key:new Q("focusEvents"),props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const s=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(s),!1},blur:(t,n)=>{e.isFocused=!1;const s=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(s),!1}}}})]}}),qi=z.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:a})=>{const{selection:l,doc:u}=a,{empty:d,$anchor:c}=l,{pos:f,parent:p}=c,m=c.parent.isTextblock&&f>0?a.doc.resolve(f-1):c,h=m.parent.type.spec.isolating,y=c.pos-c.parentOffset,g=h&&m.parent.childCount===1?y===c.pos:ge.atStart(u).from===f;return!d||!p.type.isTextblock||p.textContent.length||!g||g&&c.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),s={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},r={...s},i={...s,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return xt()||vn()?i:r},addProseMirrorPlugins(){return[new K({key:new Q("clearDocument"),appendTransaction:(e,t,n)=>{const s=e.some(h=>h.docChanged)&&!t.doc.eq(n.doc),r=e.some(h=>h.getMeta("preventClearDocument"));if(!s||r)return;const{empty:i,from:o,to:a}=t.selection,l=ge.atStart(t.doc).from,u=ge.atEnd(t.doc).to;if(i||!(o===l&&a===u)||!Xe(n.doc))return;const f=n.tr,p=qe({state:n,transaction:f}),{commands:m}=new Ge({editor:this.editor,state:p});if(m.clearNodes(),!!f.steps.length)return f}})]}}),Gi=z.create({name:"paste",addProseMirrorPlugins(){return[new K({key:new Q("tiptapPaste"),props:{handlePaste:(e,t,n)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:n})}}})]}}),Qi=z.create({name:"tabindex",addProseMirrorPlugins(){return[new K({key:new Q("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class me{get name(){return this.node.type.name}constructor(t,n,s=!1,r=null){this.currentNode=null,this.actualDepth=null,this.isBlock=s,this.resolvedPos=t,this.editor=n,this.currentNode=r}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!==null&&t!==void 0?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let n=this.from,s=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,s=this.to-1}this.editor.commands.insertContentAt({from:n,to:s},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(t);return new me(n,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new me(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new me(t,this.editor)}get children(){const t=[];return this.node.content.forEach((n,s)=>{const r=n.isBlock&&!n.isTextblock,i=n.isAtom&&!n.isText,o=this.pos+s+(i?0:1),a=this.resolvedPos.doc.resolve(o);if(!r&&a.depth<=this.depth)return;const l=new me(a,this.editor,r,r?n:null);r&&(l.actualDepth=this.depth+1),t.push(new me(a,this.editor,r,r?n:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,n={}){let s=null,r=this.parent;for(;r&&!s;){if(r.node.type.name===t)if(Object.keys(n).length>0){const i=r.node.attrs,o=Object.keys(n);for(let a=0;a<o.length;a+=1){const l=o[a];if(i[l]!==n[l])break}}else s=r;r=r.parent}return s}querySelector(t,n={}){return this.querySelectorAll(t,n,!0)[0]||null}querySelectorAll(t,n={},s=!1){let r=[];if(!this.children||this.children.length===0)return r;const i=Object.keys(n);return this.children.forEach(o=>{s&&r.length>0||(o.node.type.name===t&&i.every(l=>n[l]===o.node.attrs[l])&&r.push(o),!(s&&r.length>0)&&(r=r.concat(o.querySelectorAll(t,n,s))))}),r}setAttribute(t){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...t}),this.editor.view.dispatch(n)}}const Ji=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function Yi(e,t,n){const s=document.querySelector("style[data-tiptap-style]");if(s!==null)return s;const r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.setAttribute("data-tiptap-style",""),r.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(r),r}class Xi extends dr{constructor(t={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:s,moved:r})=>this.options.onDrop(n,s,r)),this.on("paste",({event:n,slice:s})=>this.options.onPaste(n,s)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=Yi(Ji,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,n=!0){this.setOptions({editable:t}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,n){const s=En(n)?n(t,[...this.state.plugins]):[...this.state.plugins,t],r=this.state.reconfigure({plugins:s});return this.view.updateState(r),r}unregisterPlugin(t){if(this.isDestroyed)return;const n=this.state.plugins;let s=n;if([].concat(t).forEach(i=>{const o=typeof i=="string"?`${i}$`:i.key;s=n.filter(a=>!a.key.startsWith(o))}),n.length===s.length)return;const r=this.state.reconfigure({plugins:s});return this.view.updateState(r),r}createExtensionManager(){var t,n;const r=[...this.options.enableCoreExtensions?[Ki,Tr.configure({blockSeparator:(n=(t=this.options.coreExtensionOptions)===null||t===void 0?void 0:t.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),Ui,Vi,qi,Qi,Wi,Gi].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i==null?void 0:i.type));this.extensionManager=new Ee(r,this)}createCommandManager(){this.commandManager=new Ge({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var t;let n;try{n=ct(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(o){if(!(o instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(o.message))throw o;this.emit("contentError",{editor:this,error:o,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(a=>a.name!=="collaboration"),this.createExtensionManager()}}),n=ct(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const s=Tn(n,this.options.autofocus);this.view=new ys(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(t=this.options.editorProps)===null||t===void 0?void 0:t.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:fs.create({doc:n,selection:s||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(o=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(o)});return}const n=this.state.apply(t),s=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:t,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:t}),s&&this.emit("selectionUpdate",{editor:this,transaction:t});const r=t.getMeta("focus"),i=t.getMeta("blur");r&&this.emit("focus",{editor:this,event:r.event,transaction:t}),i&&this.emit("blur",{editor:this,event:i.event,transaction:t}),!(!t.docChanged||t.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return Ln(this.state,t)}isActive(t,n){const s=typeof t=="string"?t:null,r=typeof t=="string"?n:t;return ki(this.state,s,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return wt(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:n=`

`,textSerializers:s={}}=t||{};return _n(this.state.doc,{blockSeparator:n,textSerializers:{...Et(this.schema),...s}})}get isEmpty(){return Xe(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const t=this.view.dom;t&&t.editor&&delete t.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var t;return!(!((t=this.view)===null||t===void 0)&&t.docView)}$node(t,n){var s;return((s=this.$doc)===null||s===void 0?void 0:s.querySelector(t,n))||null}$nodes(t,n){var s;return((s=this.$doc)===null||s===void 0?void 0:s.querySelectorAll(t,n))||null}$pos(t){const n=this.state.doc.resolve(t);return new me(n,this)}get $doc(){return this.$pos(0)}}function Se(e){return new Oe({find:e.find,handler:({state:t,range:n,match:s})=>{const r=O(e.getAttributes,void 0,s);if(r===!1||r===null)return null;const{tr:i}=t,o=s[s.length-1],a=s[0];if(o){const l=a.search(/\S/),u=n.from+a.indexOf(o),d=u+o.length;if(Ct(n.from,n.to,t.doc).filter(p=>p.mark.type.excluded.find(h=>h===e.type&&h!==p.mark.type)).filter(p=>p.to>u).length)return null;d<n.to&&i.delete(d,n.to),u>n.from&&i.delete(n.from+l,u);const f=n.from+l+o.length;i.addMark(n.from+l,f,e.type.create(r||{})),i.removeStoredMark(e.type)}}})}function Nn(e){return new Oe({find:e.find,handler:({state:t,range:n,match:s})=>{const r=O(e.getAttributes,void 0,s)||{},{tr:i}=t,o=n.from;let a=n.to;const l=e.type.create(r);if(s[1]){const u=s[0].lastIndexOf(s[1]);let d=o+u;d>a?d=a:a=d+s[1].length;const c=s[0][s[0].length-1];i.insertText(c,o+s[0].length-1),i.replaceWith(d,a,l)}else if(s[0]){const u=e.type.isInline?o:o-1;i.insert(u,e.type.create(r)).delete(i.mapping.map(o),i.mapping.map(a))}i.scrollIntoView()}})}function pt(e){return new Oe({find:e.find,handler:({state:t,range:n,match:s})=>{const r=t.doc.resolve(n.from),i=O(e.getAttributes,void 0,s)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,i)}})}function j(e){return new Oe({find:e.find,handler:({state:t,range:n,match:s})=>{let r=e.replace,i=n.from;const o=n.to;if(s[1]){const a=s[0].lastIndexOf(s[1]);r+=s[0].slice(a+s[1].length),i+=a;const l=i-o;l>0&&(r=s[0].slice(a-l,a)+r,i=o)}t.tr.insertText(r,i,o)}})}function Ce(e){return new Oe({find:e.find,handler:({state:t,range:n,match:s,chain:r})=>{const i=O(e.getAttributes,void 0,s)||{},o=t.tr.delete(n.from,n.to),l=o.doc.resolve(n.from).blockRange(),u=l&&Bs(l,e.type,i);if(!u)return null;if(o.wrap(l,u),e.keepMarks&&e.editor){const{selection:c,storedMarks:f}=t,{splittableMarks:p}=e.editor.extensionManager,m=f||c.$to.parentOffset&&c.$from.marks();if(m){const h=m.filter(y=>p.includes(y.type.name));o.ensureMarks(h)}}if(e.keepAttributes){const c=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";r().updateAttributes(c,i).run()}const d=o.doc.resolve(n.from-1).nodeBefore;d&&d.type===e.type&&bt(o.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(s,d))&&o.join(n.from-1)}})}class U{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=O(E(this,"addOptions",{name:this.name}))),this.storage=O(E(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new U(t)}configure(t={}){const n=this.extend({...this.config,addOptions:()=>Je(this.options,t)});return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new U(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=O(E(n,"addOptions",{name:n.name})),n.storage=O(E(n,"addStorage",{name:n.name,options:n.options})),n}}function Zi(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}class eo{constructor(t,n,s){this.isDragging=!1,this.component=t,this.editor=n.editor,this.options={stopEvent:null,ignoreMutation:null,...s},this.extension=n.extension,this.node=n.node,this.decorations=n.decorations,this.innerDecorations=n.innerDecorations,this.view=n.view,this.HTMLAttributes=n.HTMLAttributes,this.getPos=n.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(t){var n,s,r,i,o,a,l;const{view:u}=this.editor,d=t.target,c=d.nodeType===3?(n=d.parentElement)===null||n===void 0?void 0:n.closest("[data-drag-handle]"):d.closest("[data-drag-handle]");if(!this.dom||!((s=this.contentDOM)===null||s===void 0)&&s.contains(d)||!c)return;let f=0,p=0;if(this.dom!==c){const g=this.dom.getBoundingClientRect(),w=c.getBoundingClientRect(),S=(r=t.offsetX)!==null&&r!==void 0?r:(i=t.nativeEvent)===null||i===void 0?void 0:i.offsetX,C=(o=t.offsetY)!==null&&o!==void 0?o:(a=t.nativeEvent)===null||a===void 0?void 0:a.offsetY;f=w.x-g.x+S,p=w.y-g.y+C}(l=t.dataTransfer)===null||l===void 0||l.setDragImage(this.dom,f,p);const m=this.getPos();if(typeof m!="number")return;const h=ke.create(u.state.doc,m),y=u.state.tr.setSelection(h);u.dispatch(y)}stopEvent(t){var n;if(!this.dom)return!1;if(typeof this.options.stopEvent=="function")return this.options.stopEvent({event:t});const s=t.target;if(!(this.dom.contains(s)&&!(!((n=this.contentDOM)===null||n===void 0)&&n.contains(s))))return!1;const i=t.type.startsWith("drag"),o=t.type==="drop";if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(s.tagName)||s.isContentEditable)&&!o&&!i)return!0;const{isEditable:l}=this.editor,{isDragging:u}=this,d=!!this.node.type.spec.draggable,c=ke.isSelectable(this.node),f=t.type==="copy",p=t.type==="paste",m=t.type==="cut",h=t.type==="mousedown";if(!d&&c&&i&&t.target===this.dom&&t.preventDefault(),d&&i&&!u&&t.target===this.dom)return t.preventDefault(),!1;if(d&&l&&!u&&h){const y=s.closest("[data-drag-handle]");y&&(this.dom===y||this.dom.contains(y))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(u||o||f||p||m||h&&c)}ignoreMutation(t){return!this.dom||!this.contentDOM?!0:typeof this.options.ignoreMutation=="function"?this.options.ignoreMutation({mutation:t}):this.node.isLeaf||this.node.isAtom?!0:t.type==="selection"||this.dom.contains(t.target)&&t.type==="childList"&&(xt()||Zi())&&this.editor.isFocused&&[...Array.from(t.addedNodes),...Array.from(t.removedNodes)].every(s=>s.isContentEditable)?!1:this.contentDOM===t.target&&t.type==="attributes"?!0:!this.contentDOM.contains(t.target)}updateAttributes(t){this.editor.commands.command(({tr:n})=>{const s=this.getPos();return typeof s!="number"?!1:(n.setNodeMarkup(s,void 0,{...this.node.attrs,...t}),!0)})}deleteNode(){const t=this.getPos();if(typeof t!="number")return;const n=t+this.node.nodeSize;this.editor.commands.deleteRange({from:t,to:n})}}function be(e){return new kn({find:e.find,handler:({state:t,range:n,match:s,pasteEvent:r})=>{const i=O(e.getAttributes,void 0,s,r);if(i===!1||i===null)return null;const{tr:o}=t,a=s[s.length-1],l=s[0];let u=n.to;if(a){const d=l.search(/\S/),c=n.from+l.indexOf(a),f=c+a.length;if(Ct(n.from,n.to,t.doc).filter(m=>m.mark.type.excluded.find(y=>y===e.type&&y!==m.mark.type)).filter(m=>m.to>c).length)return null;f<n.to&&o.delete(f,n.to),c>n.from&&o.delete(n.from+d,c),u=n.from+d+a.length,o.addMark(n.from+d,u,e.type.create(i||{})),o.removeStoredMark(e.type)}}})}function to(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function no(e){return new kn({find:e.find,handler({match:t,chain:n,range:s,pasteEvent:r}){const i=O(e.getAttributes,void 0,t,r),o=O(e.getContent,void 0,i);if(i===!1||i===null)return null;const a={type:e.type.name,attrs:i};o&&(a.content=o),t.input&&n().deleteRange(s).insertContentAt(s.from,a)}})}class so{constructor({editor:t,element:n,view:s,tippyOptions:r={},updateDelay:i=250,shouldShow:o}){this.preventHide=!1,this.shouldShow=({view:a,state:l,from:u,to:d})=>{const{doc:c,selection:f}=l,{empty:p}=f,m=!c.textBetween(u,d).length&&St(l.selection),h=this.element.contains(document.activeElement);return!(!(a.hasFocus()||h)||p||m||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:a})=>{var l;if(this.preventHide){this.preventHide=!1;return}a!=null&&a.relatedTarget&&(!((l=this.element.parentNode)===null||l===void 0)&&l.contains(a.relatedTarget))||(a==null?void 0:a.relatedTarget)!==this.editor.view.dom&&this.hide()},this.tippyBlurHandler=a=>{this.blurHandler({event:a})},this.handleDebouncedUpdate=(a,l)=>{const u=!(l!=null&&l.selection.eq(a.state.selection)),d=!(l!=null&&l.doc.eq(a.state.doc));!u&&!d||(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(a,u,d,l)},this.updateDelay))},this.updateHandler=(a,l,u,d)=>{var c,f,p;const{state:m,composing:h}=a,{selection:y}=m;if(h||!l&&!u)return;this.createTooltip();const{ranges:w}=y,S=Math.min(...w.map(k=>k.$from.pos)),C=Math.max(...w.map(k=>k.$to.pos));if(!((c=this.shouldShow)===null||c===void 0?void 0:c.call(this,{editor:this.editor,element:this.element,view:a,state:m,oldState:d,from:S,to:C}))){this.hide();return}(f=this.tippy)===null||f===void 0||f.setProps({getReferenceClientRect:((p=this.tippyOptions)===null||p===void 0?void 0:p.getReferenceClientRect)||(()=>{if(Rn(m.selection)){let k=a.nodeDOM(S);if(k){const R=k.dataset.nodeViewWrapper?k:k.querySelector("[data-node-view-wrapper]");if(R&&(k=R.firstChild),k)return k.getBoundingClientRect()}}return Pn(a,S,C)})}),this.show()},this.editor=t,this.element=n,this.view=s,this.updateDelay=i,o&&(this.shouldShow=o),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=r,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,n=!!t.parentElement;this.tippy||!n||(this.tippy=mn(t,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(t,n){const{state:s}=t,r=s.selection.from!==s.selection.to;if(this.updateDelay>0&&r){this.handleDebouncedUpdate(t,n);return}const i=!(n!=null&&n.selection.eq(t.state.selection)),o=!(n!=null&&n.doc.eq(t.state.doc));this.updateHandler(t,i,o,n)}show(){var t;(t=this.tippy)===null||t===void 0||t.show()}hide(){var t;(t=this.tippy)===null||t===void 0||t.hide()}destroy(){var t,n;!((t=this.tippy)===null||t===void 0)&&t.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const In=e=>new K({key:typeof e.pluginKey=="string"?new Q(e.pluginKey):e.pluginKey,view:t=>new so({view:t,...e})}),au=z.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[In({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});class ro{getTextContent(t){return _n(t,{textSerializers:Et(this.editor.schema)})}constructor({editor:t,element:n,view:s,tippyOptions:r={},shouldShow:i}){this.preventHide=!1,this.shouldShow=({view:o,state:a})=>{const{selection:l}=a,{$anchor:u,empty:d}=l,c=u.depth===1,f=u.parent.isTextblock&&!u.parent.type.spec.code&&!u.parent.textContent&&u.parent.childCount===0&&!this.getTextContent(u.parent);return!(!o.hasFocus()||!d||!c||!f||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:o})=>{var a;if(this.preventHide){this.preventHide=!1;return}o!=null&&o.relatedTarget&&(!((a=this.element.parentNode)===null||a===void 0)&&a.contains(o.relatedTarget))||(o==null?void 0:o.relatedTarget)!==this.editor.view.dom&&this.hide()},this.tippyBlurHandler=o=>{this.blurHandler({event:o})},this.editor=t,this.element=n,this.view=s,i&&(this.shouldShow=i),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=r,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,n=!!t.parentElement;this.tippy||!n||(this.tippy=mn(t,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(t,n){var s,r,i;const{state:o}=t,{doc:a,selection:l}=o,{from:u,to:d}=l;if(n&&n.doc.eq(a)&&n.selection.eq(l))return;if(this.createTooltip(),!((s=this.shouldShow)===null||s===void 0?void 0:s.call(this,{editor:this.editor,view:t,state:o,oldState:n}))){this.hide();return}(r=this.tippy)===null||r===void 0||r.setProps({getReferenceClientRect:((i=this.tippyOptions)===null||i===void 0?void 0:i.getReferenceClientRect)||(()=>Pn(t,u,d))}),this.show()}show(){var t;(t=this.tippy)===null||t===void 0||t.show()}hide(){var t;(t=this.tippy)===null||t===void 0||t.hide()}destroy(){var t,n;!((t=this.tippy)===null||t===void 0)&&t.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const $n=e=>new K({key:typeof e.pluginKey=="string"?new Q(e.pluginKey):e.pluginKey,view:t=>new ro({view:t,...e})});z.create({name:"floatingMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"floatingMenu",shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[$n({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}});function io(e){return e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Hn={exports:{}},at={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jt;function oo(){if(Jt)return at;Jt=1;var e=B;function t(c,f){return c===f&&(c!==0||1/c===1/f)||c!==c&&f!==f}var n=typeof Object.is=="function"?Object.is:t,s=e.useState,r=e.useEffect,i=e.useLayoutEffect,o=e.useDebugValue;function a(c,f){var p=f(),m=s({inst:{value:p,getSnapshot:f}}),h=m[0].inst,y=m[1];return i(function(){h.value=p,h.getSnapshot=f,l(h)&&y({inst:h})},[c,p,f]),r(function(){return l(h)&&y({inst:h}),c(function(){l(h)&&y({inst:h})})},[c]),o(p),p}function l(c){var f=c.getSnapshot;c=c.value;try{var p=f();return!n(c,p)}catch{return!0}}function u(c,f){return f()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:a;return at.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,at}Hn.exports=oo();var vt=Hn.exports;const ao=(...e)=>t=>{e.forEach(n=>{typeof n=="function"?n(t):n&&(n.current=t)})},lo=({contentComponent:e})=>{const t=vt.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getServerSnapshot);return B.createElement(B.Fragment,null,Object.values(t))};function uo(){const e=new Set;let t={};return{subscribe(n){return e.add(n),()=>{e.delete(n)}},getSnapshot(){return t},getServerSnapshot(){return t},setRenderer(n,s){t={...t,[n]:ps.createPortal(s.reactElement,s.element,n)},e.forEach(r=>r())},removeRenderer(n){const s={...t};delete s[n],t=s,e.forEach(r=>r())}}}class co extends B.Component{constructor(t){var n;super(t),this.editorContentRef=B.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((n=t.editor)===null||n===void 0)&&n.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const t=this.props.editor;if(t&&!t.isDestroyed&&t.options.element){if(t.contentComponent)return;const n=this.editorContentRef.current;n.append(...t.options.element.childNodes),t.setOptions({element:n}),t.contentComponent=uo(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=t.contentComponent.subscribe(()=>{this.setState(s=>s.hasContentComponentInitialized?s:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),t.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const t=this.props.editor;if(!t||(this.initialized=!1,t.isDestroyed||t.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),t.contentComponent=null,!t.options.element.firstChild))return;const n=document.createElement("div");n.append(...t.options.element.childNodes),t.setOptions({element:n})}render(){const{editor:t,innerRef:n,...s}=this.props;return B.createElement(B.Fragment,null,B.createElement("div",{ref:ao(n,this.editorContentRef),...s}),(t==null?void 0:t.contentComponent)&&B.createElement(lo,{contentComponent:t.contentComponent}))}}const fo=G.forwardRef((e,t)=>{const n=B.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[e.editor]);return B.createElement(co,{key:n,innerRef:t,...e})}),lu=B.memo(fo);var po=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var s,r,i;if(Array.isArray(t)){if(s=t.length,s!=n.length)return!1;for(r=s;r--!==0;)if(!e(t[r],n[r]))return!1;return!0}if(t instanceof Map&&n instanceof Map){if(t.size!==n.size)return!1;for(r of t.entries())if(!n.has(r[0]))return!1;for(r of t.entries())if(!e(r[1],n.get(r[0])))return!1;return!0}if(t instanceof Set&&n instanceof Set){if(t.size!==n.size)return!1;for(r of t.entries())if(!n.has(r[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(n)){if(s=t.length,s!=n.length)return!1;for(r=s;r--!==0;)if(t[r]!==n[r])return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(i=Object.keys(t),s=i.length,s!==Object.keys(n).length)return!1;for(r=s;r--!==0;)if(!Object.prototype.hasOwnProperty.call(n,i[r]))return!1;for(r=s;r--!==0;){var o=i[r];if(!(o==="_owner"&&t.$$typeof)&&!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n},ho=io(po),Dn={exports:{}},lt={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yt;function mo(){if(Yt)return lt;Yt=1;var e=B,t=vt;function n(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var s=typeof Object.is=="function"?Object.is:n,r=t.useSyncExternalStore,i=e.useRef,o=e.useEffect,a=e.useMemo,l=e.useDebugValue;return lt.useSyncExternalStoreWithSelector=function(u,d,c,f,p){var m=i(null);if(m.current===null){var h={hasValue:!1,value:null};m.current=h}else h=m.current;m=a(function(){function g(k){if(!w){if(w=!0,S=k,k=f(k),p!==void 0&&h.hasValue){var R=h.value;if(p(R,k))return C=R}return C=k}if(R=C,s(S,k))return R;var F=f(k);return p!==void 0&&p(R,F)?R:(S=k,C=F)}var w=!1,S,C,L=c===void 0?null:c;return[function(){return g(d())},L===null?void 0:function(){return g(L())}]},[d,c,f,p]);var y=r(u,m[0],m[1]);return o(function(){h.hasValue=!0,h.value=y},[y]),l(y),y},lt}Dn.exports=mo();var go=Dn.exports;const yo=typeof window<"u"?G.useLayoutEffect:G.useEffect;class bo{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const n=()=>{this.transactionNumber+=1,this.subscribers.forEach(r=>r())},s=this.editor;return s.on("transaction",n),()=>{s.off("transaction",n)}}}}function wo(e){var t;const[n]=G.useState(()=>new bo(e.editor)),s=go.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,e.selector,(t=e.equalityFn)!==null&&t!==void 0?t:ho);return yo(()=>n.watch(e.editor),[e.editor,n]),G.useDebugValue(s),s}const Mo=!1,ht=typeof window>"u",Eo=ht||!!(typeof window<"u"&&window.next);class ko{constructor(t){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=t,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(t){this.editor=t,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?ht||Eo?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const t={...this.options.current,onBeforeCreate:(...s)=>{var r,i;return(i=(r=this.options.current).onBeforeCreate)===null||i===void 0?void 0:i.call(r,...s)},onBlur:(...s)=>{var r,i;return(i=(r=this.options.current).onBlur)===null||i===void 0?void 0:i.call(r,...s)},onCreate:(...s)=>{var r,i;return(i=(r=this.options.current).onCreate)===null||i===void 0?void 0:i.call(r,...s)},onDestroy:(...s)=>{var r,i;return(i=(r=this.options.current).onDestroy)===null||i===void 0?void 0:i.call(r,...s)},onFocus:(...s)=>{var r,i;return(i=(r=this.options.current).onFocus)===null||i===void 0?void 0:i.call(r,...s)},onSelectionUpdate:(...s)=>{var r,i;return(i=(r=this.options.current).onSelectionUpdate)===null||i===void 0?void 0:i.call(r,...s)},onTransaction:(...s)=>{var r,i;return(i=(r=this.options.current).onTransaction)===null||i===void 0?void 0:i.call(r,...s)},onUpdate:(...s)=>{var r,i;return(i=(r=this.options.current).onUpdate)===null||i===void 0?void 0:i.call(r,...s)},onContentError:(...s)=>{var r,i;return(i=(r=this.options.current).onContentError)===null||i===void 0?void 0:i.call(r,...s)},onDrop:(...s)=>{var r,i;return(i=(r=this.options.current).onDrop)===null||i===void 0?void 0:i.call(r,...s)},onPaste:(...s)=>{var r,i;return(i=(r=this.options.current).onPaste)===null||i===void 0?void 0:i.call(r,...s)}};return new Xi(t)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(t){return this.subscriptions.add(t),()=>{this.subscriptions.delete(t)}}onRender(t){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&t.length===0?this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(t),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(t){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=t;return}if(this.previousDeps.length===t.length&&this.previousDeps.every((s,r)=>s===t[r]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=t}scheduleDestroy(){const t=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===t){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===t&&this.setEditor(null))},1)}}function uu(e={},t=[]){const n=G.useRef(e);n.current=e;const[s]=G.useState(()=>new ko(n)),r=vt.useSyncExternalStore(s.subscribe,s.getEditor,s.getServerSnapshot);return G.useDebugValue(r),G.useEffect(s.onRender(t)),wo({editor:r,selector:({transactionNumber:i})=>e.shouldRerenderOnTransaction===!1?null:e.immediatelyRender&&i===0?0:i+1}),r}const Bn=G.createContext({editor:null});Bn.Consumer;const jn=()=>G.useContext(Bn),cu=e=>{const[t,n]=G.useState(null),{editor:s}=jn();return G.useEffect(()=>{var r;if(!t||!((r=e.editor)===null||r===void 0)&&r.isDestroyed||s!=null&&s.isDestroyed)return;const{pluginKey:i="bubbleMenu",editor:o,tippyOptions:a={},updateDelay:l,shouldShow:u=null}=e,d=o||s;if(!d){console.warn("BubbleMenu component is not rendered inside of an editor component or does not have editor prop.");return}const c=In({updateDelay:l,editor:d,element:t,pluginKey:i,shouldShow:u,tippyOptions:a});return d.registerPlugin(c),()=>{d.unregisterPlugin(i)}},[e.editor,s,t]),B.createElement("div",{ref:n,className:e.className,style:{visibility:"hidden"}},e.children)},du=e=>{const[t,n]=G.useState(null),{editor:s}=jn();return G.useEffect(()=>{var r;if(!t||!((r=e.editor)===null||r===void 0)&&r.isDestroyed||s!=null&&s.isDestroyed)return;const{pluginKey:i="floatingMenu",editor:o,tippyOptions:a={},shouldShow:l=null}=e,u=o||s;if(!u){console.warn("FloatingMenu component is not rendered inside of an editor component or does not have editor prop.");return}const d=$n({pluginKey:i,editor:u,element:t,tippyOptions:a,shouldShow:l});return u.registerPlugin(d),()=>{u.unregisterPlugin(i)}},[e.editor,s,t]),B.createElement("div",{ref:n,className:e.className,style:{visibility:"hidden"}},e.children)},Fn=G.createContext({onDragStart:void 0}),zn=()=>G.useContext(Fn),fu=e=>{const t=e.as||"div",{nodeViewContentRef:n}=zn();return B.createElement(t,{...e,ref:n,"data-node-view-content":"",style:{whiteSpace:"pre-wrap",...e.style}})},pu=B.forwardRef((e,t)=>{const{onDragStart:n}=zn(),s=e.as||"div";return B.createElement(s,{...e,ref:t,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...e.style}})});function So(e){return!!(typeof e=="function"&&e.prototype&&e.prototype.isReactComponent)}function xo(e){var t;return typeof e=="object"&&((t=e.$$typeof)===null||t===void 0?void 0:t.toString())==="Symbol(react.forward_ref)"}class To{constructor(t,{editor:n,props:s={},as:r="div",className:i=""}){this.ref=null,this.id=Math.floor(Math.random()*4294967295).toString(),this.component=t,this.editor=n,this.props=s,this.element=document.createElement(r),this.element.classList.add("react-renderer"),i&&this.element.classList.add(...i.split(" ")),this.editor.isInitialized?hs.flushSync(()=>{this.render()}):this.render()}render(){var t;const n=this.component,s=this.props,r=this.editor;(So(n)||xo(n))&&(s.ref=i=>{this.ref=i}),this.reactElement=B.createElement(n,{...s}),(t=r==null?void 0:r.contentComponent)===null||t===void 0||t.setRenderer(this.id,this)}updateProps(t={}){this.props={...this.props,...t},this.render()}destroy(){var t;const n=this.editor;(t=n==null?void 0:n.contentComponent)===null||t===void 0||t.removeRenderer(this.id)}updateAttributes(t){Object.keys(t).forEach(n=>{this.element.setAttribute(n,t[n])})}}class Co extends eo{mount(){const t={editor:this.editor,node:this.node,decorations:this.decorations,innerDecorations:this.innerDecorations,view:this.view,selected:!1,extension:this.extension,HTMLAttributes:this.HTMLAttributes,getPos:()=>this.getPos(),updateAttributes:(u={})=>this.updateAttributes(u),deleteNode:()=>this.deleteNode()};if(!this.component.displayName){const u=d=>d.charAt(0).toUpperCase()+d.substring(1);this.component.displayName=u(this.extension.name)}const r={onDragStart:this.onDragStart.bind(this),nodeViewContentRef:u=>{u&&this.contentDOMElement&&u.firstChild!==this.contentDOMElement&&u.appendChild(this.contentDOMElement)}},i=this.component,o=B.memo(u=>B.createElement(Fn.Provider,{value:r},B.createElement(i,u)));o.displayName="ReactNodeView",this.node.isLeaf?this.contentDOMElement=null:this.options.contentDOMElementTag?this.contentDOMElement=document.createElement(this.options.contentDOMElementTag):this.contentDOMElement=document.createElement(this.node.isInline?"span":"div"),this.contentDOMElement&&(this.contentDOMElement.dataset.nodeViewContentReact="",this.contentDOMElement.style.whiteSpace="inherit");let a=this.node.isInline?"span":"div";this.options.as&&(a=this.options.as);const{className:l=""}=this.options;this.handleSelectionUpdate=this.handleSelectionUpdate.bind(this),this.renderer=new To(o,{editor:this.editor,props:t,as:a,className:`node-${this.node.type.name} ${l}`.trim()}),this.editor.on("selectionUpdate",this.handleSelectionUpdate),this.updateElementAttributes()}get dom(){var t;if(this.renderer.element.firstElementChild&&!(!((t=this.renderer.element.firstElementChild)===null||t===void 0)&&t.hasAttribute("data-node-view-wrapper")))throw Error("Please use the NodeViewWrapper component for your node view.");return this.renderer.element}get contentDOM(){return this.node.isLeaf?null:this.contentDOMElement}handleSelectionUpdate(){const{from:t,to:n}=this.editor.state.selection,s=this.getPos();if(typeof s=="number")if(t<=s&&n>=s+this.node.nodeSize){if(this.renderer.props.selected)return;this.selectNode()}else{if(!this.renderer.props.selected)return;this.deselectNode()}}update(t,n,s){const r=i=>{this.renderer.updateProps(i),typeof this.options.attrs=="function"&&this.updateElementAttributes()};if(t.type!==this.node.type)return!1;if(typeof this.options.update=="function"){const i=this.node,o=this.decorations,a=this.innerDecorations;return this.node=t,this.decorations=n,this.innerDecorations=s,this.options.update({oldNode:i,oldDecorations:o,newNode:t,newDecorations:n,oldInnerDecorations:a,innerDecorations:s,updateProps:()=>r({node:t,decorations:n,innerDecorations:s})})}return t===this.node&&this.decorations===n&&this.innerDecorations===s||(this.node=t,this.decorations=n,this.innerDecorations=s,r({node:t,decorations:n,innerDecorations:s})),!0}selectNode(){this.renderer.updateProps({selected:!0}),this.renderer.element.classList.add("ProseMirror-selectednode")}deselectNode(){this.renderer.updateProps({selected:!1}),this.renderer.element.classList.remove("ProseMirror-selectednode")}destroy(){this.renderer.destroy(),this.editor.off("selectionUpdate",this.handleSelectionUpdate),this.contentDOMElement=null}updateElementAttributes(){if(this.options.attrs){let t={};if(typeof this.options.attrs=="function"){const n=this.editor.extensionManager.attributes,s=Ue(this.node,n);t=this.options.attrs({node:this.node,HTMLAttributes:s})}else t=this.options.attrs;this.renderer.updateAttributes(t)}}}function hu(e,t){return n=>n.editor.contentComponent?new Co(e,n,t):{}}const vo=e=>{if(!e.children.length)return;const t=e.querySelectorAll("span");t&&t.forEach(n=>{var s,r;const i=n.getAttribute("style"),o=(r=(s=n.parentElement)===null||s===void 0?void 0:s.closest("span"))===null||r===void 0?void 0:r.getAttribute("style");n.setAttribute("style",`${o};${i}`)})},mu=ne.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!1}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&vo(e),{}):!1}]},renderHTML({HTMLAttributes:e}){return["span",I(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({tr:e})=>{const{selection:t}=e;return e.doc.nodesBetween(t.from,t.to,(n,s)=>{if(n.isTextblock)return!0;n.marks.filter(r=>r.type===this.type).some(r=>Object.values(r.attrs).some(i=>!!i))||e.removeMark(s,s+n.nodeSize,this.type)}),!0}}}}),gu=z.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:e=>{var t;return(t=e.style.color)===null||t===void 0?void 0:t.replace(/['"]+/g,"")},renderHTML:e=>e.color?{style:`color: ${e.color}`}:{}}}}]},addCommands(){return{setColor:e=>({chain:t})=>t().setMark("textStyle",{color:e}).run(),unsetColor:()=>({chain:e})=>e().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),Ao=U.create({name:"doc",topNode:!0,content:"block+"});function Oo(e){return e.length===1?e[0].isLink:e.length===3&&e[1].isLink?["()","[]"].includes(e[0].value+e[2].value):!1}function _o(e){return new K({key:new Q("autolink"),appendTransaction:(t,n,s)=>{const r=t.some(u=>u.docChanged)&&!n.doc.eq(s.doc),i=t.some(u=>u.getMeta("preventAutolink"));if(!r||i)return;const{tr:o}=s,a=mi(n.doc,[...t]);if(Ei(a).forEach(({newRange:u})=>{const d=yi(s.doc,u,p=>p.isTextblock);let c,f;if(d.length>1?(c=d[0],f=s.doc.textBetween(c.pos,c.pos+c.node.nodeSize,void 0," ")):d.length&&s.doc.textBetween(u.from,u.to," "," ").endsWith(" ")&&(c=d[0],f=s.doc.textBetween(c.pos,u.to,void 0," ")),c&&f){const p=f.split(" ").filter(g=>g!=="");if(p.length<=0)return!1;const m=p[p.length-1],h=c.pos+f.lastIndexOf(m);if(!m)return!1;const y=ms(m).map(g=>g.toObject(e.defaultProtocol));if(!Oo(y))return!1;y.filter(g=>g.isLink).map(g=>({...g,from:h+g.start+1,to:h+g.end+1})).filter(g=>s.schema.marks.code?!s.doc.rangeHasMark(g.from,g.to,s.schema.marks.code):!0).filter(g=>e.validate(g.value)).filter(g=>e.shouldAutoLink(g.value)).forEach(g=>{Ct(g.from,g.to,s.doc).some(w=>w.mark.type===e.type)||o.addMark(g.from,g.to,e.type.create({href:g.href}))})}}),!!o.steps.length)return o}})}function Lo(e){return new K({key:new Q("handleClickLink"),props:{handleClick:(t,n,s)=>{var r,i;if(s.button!==0||!t.editable)return!1;let o=s.target;const a=[];for(;o.nodeName!=="DIV";)a.push(o),o=o.parentNode;if(!a.find(f=>f.nodeName==="A"))return!1;const l=Ln(t.state,e.type.name),u=s.target,d=(r=u==null?void 0:u.href)!==null&&r!==void 0?r:l.href,c=(i=u==null?void 0:u.target)!==null&&i!==void 0?i:l.target;return u&&d?(window.open(d,c),!0):!1}}})}function Ro(e){return new K({key:new Q("handlePasteLink"),props:{handlePaste:(t,n,s)=>{const{state:r}=t,{selection:i}=r,{empty:o}=i;if(o)return!1;let a="";s.content.forEach(u=>{a+=u.textContent});const l=gn(a,{defaultProtocol:e.defaultProtocol}).find(u=>u.isLink&&u.value===a);return!a||!l?!1:e.editor.commands.setMark(e.type,{href:l.href})}}})}const Po=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g;function he(e,t){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(s=>{const r=typeof s=="string"?s:s.scheme;r&&n.push(r)}),!e||e.replace(Po,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z+.-]+(?:[^a-z+.-:]|$))`,"i"))}const yu=ne.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{if(typeof e=="string"){Ht(e);return}Ht(e.scheme,e.optionalSlashes)})},onDestroy(){gs()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!he(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>!!e}},addAttributes(){return{href:{default:null,parseHTML(e){return e.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{const t=e.getAttribute("href");return!t||!this.options.isAllowedUri(t,{defaultValidate:n=>!!he(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:e}){return this.options.isAllowedUri(e.href,{defaultValidate:t=>!!he(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",I(this.options.HTMLAttributes,e),0]:["a",I(this.options.HTMLAttributes,{...e,href:""}),0]},addCommands(){return{setLink:e=>({chain:t})=>{const{href:n}=e;return this.options.isAllowedUri(n,{defaultValidate:s=>!!he(s,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().setMark(this.name,e).setMeta("preventAutolink",!0).run():!1},toggleLink:e=>({chain:t})=>{const{href:n}=e;return this.options.isAllowedUri(n,{defaultValidate:s=>!!he(s,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run():!1},unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[be({find:e=>{const t=[];if(e){const{protocols:n,defaultProtocol:s}=this.options,r=gn(e).filter(i=>i.isLink&&this.options.isAllowedUri(i.value,{defaultValidate:o=>!!he(o,n),protocols:n,defaultProtocol:s}));r.length&&r.forEach(i=>t.push({text:i.value,data:{href:i.href},index:i.start}))}return t},type:this.type,getAttributes:e=>{var t;return{href:(t=e.data)===null||t===void 0?void 0:t.href}}})]},addProseMirrorPlugins(){const e=[],{protocols:t,defaultProtocol:n}=this.options;return this.options.autolink&&e.push(_o({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:s=>this.options.isAllowedUri(s,{defaultValidate:r=>!!he(r,t),protocols:t,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&e.push(Lo({type:this.type})),this.options.linkOnPaste&&e.push(Ro({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),e}}),No=U.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",I(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Io=U.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",I(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),bu=z.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new K({key:new Q("placeholder"),props:{decorations:({doc:e,selection:t})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:s}=t,r=[];if(!n)return null;const i=this.editor.isEmpty;return e.descendants((o,a)=>{const l=s>=a&&s<=a+o.nodeSize,u=!o.isLeaf&&Xe(o);if((l||!this.options.showOnlyCurrent)&&u){const d=[this.options.emptyNodeClass];i&&d.push(this.options.emptyEditorClass);const c=gt.node(a,a+o.nodeSize,{class:d.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:o,pos:a,hasAnchor:l}):this.options.placeholder});r.push(c)}return this.options.includeChildren}),yt.create(e,r)}}})]}}),$o=U.create({name:"text",group:"inline"}),Ho=e=>j({find:/--$/,replace:e??"—"}),Do=e=>j({find:/\.\.\.$/,replace:e??"…"}),Bo=e=>j({find:/(?:^|[\s{[(<'"\u2018\u201C])(")$/,replace:e??"“"}),jo=e=>j({find:/"$/,replace:e??"”"}),Fo=e=>j({find:/(?:^|[\s{[(<'"\u2018\u201C])(')$/,replace:e??"‘"}),zo=e=>j({find:/'$/,replace:e??"’"}),Uo=e=>j({find:/<-$/,replace:e??"←"}),Wo=e=>j({find:/->$/,replace:e??"→"}),Ko=e=>j({find:/\(c\)$/,replace:e??"©"}),Vo=e=>j({find:/\(tm\)$/,replace:e??"™"}),qo=e=>j({find:/\(sm\)$/,replace:e??"℠"}),Go=e=>j({find:/\(r\)$/,replace:e??"®"}),Qo=e=>j({find:/(?:^|\s)(1\/2)\s$/,replace:e??"½"}),Jo=e=>j({find:/\+\/-$/,replace:e??"±"}),Yo=e=>j({find:/!=$/,replace:e??"≠"}),Xo=e=>j({find:/<<$/,replace:e??"«"}),Zo=e=>j({find:/>>$/,replace:e??"»"}),ea=e=>j({find:/\d+\s?([*x])\s?\d+$/,replace:e??"×"}),ta=e=>j({find:/\^2$/,replace:e??"²"}),na=e=>j({find:/\^3$/,replace:e??"³"}),sa=e=>j({find:/(?:^|\s)(1\/4)\s$/,replace:e??"¼"}),ra=e=>j({find:/(?:^|\s)(3\/4)\s$/,replace:e??"¾"}),wu=z.create({name:"typography",addOptions(){return{closeDoubleQuote:"”",closeSingleQuote:"’",copyright:"©",ellipsis:"…",emDash:"—",laquo:"«",leftArrow:"←",multiplication:"×",notEqual:"≠",oneHalf:"½",oneQuarter:"¼",openDoubleQuote:"“",openSingleQuote:"‘",plusMinus:"±",raquo:"»",registeredTrademark:"®",rightArrow:"→",servicemark:"℠",superscriptThree:"³",superscriptTwo:"²",threeQuarters:"¾",trademark:"™"}},addInputRules(){const e=[];return this.options.emDash!==!1&&e.push(Ho(this.options.emDash)),this.options.ellipsis!==!1&&e.push(Do(this.options.ellipsis)),this.options.openDoubleQuote!==!1&&e.push(Bo(this.options.openDoubleQuote)),this.options.closeDoubleQuote!==!1&&e.push(jo(this.options.closeDoubleQuote)),this.options.openSingleQuote!==!1&&e.push(Fo(this.options.openSingleQuote)),this.options.closeSingleQuote!==!1&&e.push(zo(this.options.closeSingleQuote)),this.options.leftArrow!==!1&&e.push(Uo(this.options.leftArrow)),this.options.rightArrow!==!1&&e.push(Wo(this.options.rightArrow)),this.options.copyright!==!1&&e.push(Ko(this.options.copyright)),this.options.trademark!==!1&&e.push(Vo(this.options.trademark)),this.options.servicemark!==!1&&e.push(qo(this.options.servicemark)),this.options.registeredTrademark!==!1&&e.push(Go(this.options.registeredTrademark)),this.options.oneHalf!==!1&&e.push(Qo(this.options.oneHalf)),this.options.plusMinus!==!1&&e.push(Jo(this.options.plusMinus)),this.options.notEqual!==!1&&e.push(Yo(this.options.notEqual)),this.options.laquo!==!1&&e.push(Xo(this.options.laquo)),this.options.raquo!==!1&&e.push(Zo(this.options.raquo)),this.options.multiplication!==!1&&e.push(ea(this.options.multiplication)),this.options.superscriptTwo!==!1&&e.push(ta(this.options.superscriptTwo)),this.options.superscriptThree!==!1&&e.push(na(this.options.superscriptThree)),this.options.oneQuarter!==!1&&e.push(sa(this.options.oneQuarter)),this.options.threeQuarters!==!1&&e.push(ra(this.options.threeQuarters)),e}}),Mu=ne.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["u",I(this.options.HTMLAttributes,e),0]},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),ia=z.create({name:"gapCursor",addProseMirrorPlugins(){return[Ls()]},extendNodeSchema(e){var t;const n={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=O(E(e,"allowGapCursor",n)))!==null&&t!==void 0?t:null}}}),Eu=z.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:e=>{const t=e.style.textAlign;return this.options.alignments.includes(t)?t:this.options.defaultAlignment},renderHTML:e=>e.textAlign?{style:`text-align: ${e.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:e=>({commands:t})=>this.options.alignments.includes(e)?this.options.types.map(n=>t.updateAttributes(n,{textAlign:e})).every(n=>n):!1,unsetTextAlign:()=>({commands:e})=>this.options.types.map(t=>e.resetAttributes(t,"textAlign")).every(t=>t)}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}});function mt(e,t){return t?["width",`${Math.max(t,e)}px`]:["min-width",`${e}px`]}function Xt(e,t,n,s,r,i){var o;let a=0,l=!0,u=t.firstChild;const d=e.firstChild;if(d!==null)for(let c=0,f=0;c<d.childCount;c+=1){const{colspan:p,colwidth:m}=d.child(c).attrs;for(let h=0;h<p;h+=1,f+=1){const y=r===f?i:m&&m[h],g=y?`${y}px`:"";if(a+=y||s,y||(l=!1),u){if(u.style.width!==g){const[w,S]=mt(s,y);u.style.setProperty(w,S)}u=u.nextSibling}else{const w=document.createElement("col"),[S,C]=mt(s,y);w.style.setProperty(S,C),t.appendChild(w)}}}for(;u;){const c=u.nextSibling;(o=u.parentNode)===null||o===void 0||o.removeChild(u),u=c}l?(n.style.width=`${a}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${a}px`)}class oa{constructor(t,n){this.node=t,this.cellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Xt(t,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!==this.node.type?!1:(this.node=t,Xt(t,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(t){return t.type==="attributes"&&(t.target===this.table||this.colgroup.contains(t.target))}}function aa(e,t,n,s){let r=0,i=!0;const o=[],a=e.firstChild;if(!a)return{};for(let c=0,f=0;c<a.childCount;c+=1){const{colspan:p,colwidth:m}=a.child(c).attrs;for(let h=0;h<p;h+=1,f+=1){const y=n===f?s:m&&m[h];r+=y||t,y||(i=!1);const[g,w]=mt(t,y);o.push(["col",{style:`${g}: ${w}`}])}}const l=i?`${r}px`:"",u=i?"":`${r}px`;return{colgroup:["colgroup",{},...o],tableWidth:l,tableMinWidth:u}}function Zt(e,t){return e.createAndFill()}function la(e){if(e.cached.tableNodeTypes)return e.cached.tableNodeTypes;const t={};return Object.keys(e.nodes).forEach(n=>{const s=e.nodes[n];s.spec.tableRole&&(t[s.spec.tableRole]=s)}),e.cached.tableNodeTypes=t,t}function ua(e,t,n,s,r){const i=la(e),o=[],a=[];for(let u=0;u<n;u+=1){const d=Zt(i.cell);if(d&&a.push(d),s){const c=Zt(i.header_cell);c&&o.push(c)}}const l=[];for(let u=0;u<t;u+=1)l.push(i.row.createChecked(null,s&&u===0?o:a));return i.table.createChecked(null,l)}function ca(e){return e instanceof yn}const Be=({editor:e})=>{const{selection:t}=e.state;if(!ca(t))return!1;let n=0;const s=On(t.ranges[0].$from,i=>i.type.name==="table");return s==null||s.node.descendants(i=>{if(i.type.name==="table")return!1;["tableCell","tableHeader"].includes(i.type.name)&&(n+=1)}),n===t.ranges.length?(e.commands.deleteTable(),!0):!1},ku=U.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:oa,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:e,HTMLAttributes:t}){const{colgroup:n,tableWidth:s,tableMinWidth:r}=aa(e,this.options.cellMinWidth);return["table",I(this.options.HTMLAttributes,t,{style:s?`width: ${s}`:`min-width: ${r}`}),n,["tbody",0]]},addCommands(){return{insertTable:({rows:e=3,cols:t=3,withHeaderRow:n=!0}={})=>({tr:s,dispatch:r,editor:i})=>{const o=ua(i.schema,e,t,n);if(r){const a=s.selection.from+1;s.replaceSelectionWith(o).scrollIntoView().setSelection(X.near(s.doc.resolve(a)))}return!0},addColumnBefore:()=>({state:e,dispatch:t})=>bs(e,t),addColumnAfter:()=>({state:e,dispatch:t})=>ws(e,t),deleteColumn:()=>({state:e,dispatch:t})=>Ms(e,t),addRowBefore:()=>({state:e,dispatch:t})=>Es(e,t),addRowAfter:()=>({state:e,dispatch:t})=>ks(e,t),deleteRow:()=>({state:e,dispatch:t})=>Ss(e,t),deleteTable:()=>({state:e,dispatch:t})=>xs(e,t),mergeCells:()=>({state:e,dispatch:t})=>Dt(e,t),splitCell:()=>({state:e,dispatch:t})=>Bt(e,t),toggleHeaderColumn:()=>({state:e,dispatch:t})=>jt("column")(e,t),toggleHeaderRow:()=>({state:e,dispatch:t})=>jt("row")(e,t),toggleHeaderCell:()=>({state:e,dispatch:t})=>Ts(e,t),mergeOrSplit:()=>({state:e,dispatch:t})=>Dt(e,t)?!0:Bt(e,t),setCellAttribute:(e,t)=>({state:n,dispatch:s})=>Cs(e,t)(n,s),goToNextCell:()=>({state:e,dispatch:t})=>Ft(1)(e,t),goToPreviousCell:()=>({state:e,dispatch:t})=>Ft(-1)(e,t),fixTables:()=>({state:e,dispatch:t})=>(t&&vs(e),!0),setCellSelection:e=>({tr:t,dispatch:n})=>{if(n){const s=yn.create(t.doc,e.anchorCell,e.headCell);t.setSelection(s)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:Be,"Mod-Backspace":Be,Delete:Be,"Mod-Delete":Be}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[As({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],Os({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(e){const t={name:e.name,options:e.options,storage:e.storage};return{tableRole:O(E(e,"tableRole",t))}}}),Su=U.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{const t=e.getAttribute("colwidth");return t?t.split(",").map(s=>parseInt(s,10)):null}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:e}){return["td",I(this.options.HTMLAttributes,e),0]}}),xu=U.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{const t=e.getAttribute("colwidth");return t?t.split(",").map(s=>parseInt(s,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:e}){return["th",I(this.options.HTMLAttributes,e),0]}}),Tu=U.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:e}){return["tr",I(this.options.HTMLAttributes,e),0]}}),da=/^((?:https?:)?\/\/)?((?:www|m|music)\.)?((?:youtube\.com|youtu.be|youtube-nocookie\.com))(\/(?:[\w-]+\?v=|embed\/|v\/)?)([\w-]+)(\S+)?$/,fa=/^((?:https?:)?\/\/)?((?:www|m|music)\.)?((?:youtube\.com|youtu.be|youtube-nocookie\.com))(\/(?:[\w-]+\?v=|embed\/|v\/)?)([\w-]+)(\S+)?$/g,Un=e=>e.match(da),en=e=>e?"https://www.youtube-nocookie.com/embed/":"https://www.youtube.com/embed/",pa=e=>{const{url:t,allowFullscreen:n,autoplay:s,ccLanguage:r,ccLoadPolicy:i,controls:o,disableKBcontrols:a,enableIFrameApi:l,endTime:u,interfaceLanguage:d,ivLoadPolicy:c,loop:f,modestBranding:p,nocookie:m,origin:h,playlist:y,progressBarColor:g,startAt:w}=e;if(!Un(t))return null;if(t.includes("/embed/"))return t;if(t.includes("youtu.be")){const R=t.split("/").pop();return R?`${en(m)}${R}`:null}const C=/(?:v=|shorts\/)([-\w]+)/gm.exec(t);if(!C||!C[1])return null;let L=`${en(m)}${C[1]}`;const k=[];return n===!1&&k.push("fs=0"),s&&k.push("autoplay=1"),r&&k.push(`cc_lang_pref=${r}`),i&&k.push("cc_load_policy=1"),o||k.push("controls=0"),a&&k.push("disablekb=1"),l&&k.push("enablejsapi=1"),u&&k.push(`end=${u}`),d&&k.push(`hl=${d}`),c&&k.push(`iv_load_policy=${c}`),f&&k.push("loop=1"),p&&k.push("modestbranding=1"),h&&k.push(`origin=${h}`),y&&k.push(`playlist=${y}`),w&&k.push(`start=${w}`),g&&k.push(`color=${g}`),k.length&&(L+=`?${k.join("&")}`),L},Cu=U.create({name:"youtube",addOptions(){return{addPasteHandler:!0,allowFullscreen:!0,autoplay:!1,ccLanguage:void 0,ccLoadPolicy:void 0,controls:!0,disableKBcontrols:!1,enableIFrameApi:!1,endTime:0,height:480,interfaceLanguage:void 0,ivLoadPolicy:0,loop:!1,modestBranding:!1,HTMLAttributes:{},inline:!1,nocookie:!1,origin:"",playlist:"",progressBarColor:void 0,width:640}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},start:{default:0},width:{default:this.options.width},height:{default:this.options.height}}},parseHTML(){return[{tag:"div[data-youtube-video] iframe"}]},addCommands(){return{setYoutubeVideo:e=>({commands:t})=>Un(e.src)?t.insertContent({type:this.name,attrs:e}):!1}},addPasteRules(){return this.options.addPasteHandler?[no({find:fa,type:this.type,getAttributes:e=>({src:e.input})})]:[]},renderHTML({HTMLAttributes:e}){const t=pa({url:e.src,allowFullscreen:this.options.allowFullscreen,autoplay:this.options.autoplay,ccLanguage:this.options.ccLanguage,ccLoadPolicy:this.options.ccLoadPolicy,controls:this.options.controls,disableKBcontrols:this.options.disableKBcontrols,enableIFrameApi:this.options.enableIFrameApi,endTime:this.options.endTime,interfaceLanguage:this.options.interfaceLanguage,ivLoadPolicy:this.options.ivLoadPolicy,loop:this.options.loop,modestBranding:this.options.modestBranding,nocookie:this.options.nocookie,origin:this.options.origin,playlist:this.options.playlist,progressBarColor:this.options.progressBarColor,startAt:e.start||0});return e.src=t,["div",{"data-youtube-video":""},["iframe",I(this.options.HTMLAttributes,{width:this.options.width,height:this.options.height,allowfullscreen:this.options.allowFullscreen,autoplay:this.options.autoplay,ccLanguage:this.options.ccLanguage,ccLoadPolicy:this.options.ccLoadPolicy,disableKBcontrols:this.options.disableKBcontrols,enableIFrameApi:this.options.enableIFrameApi,endTime:this.options.endTime,interfaceLanguage:this.options.interfaceLanguage,ivLoadPolicy:this.options.ivLoadPolicy,loop:this.options.loop,modestBranding:this.options.modestBranding,origin:this.options.origin,playlist:this.options.playlist,progressBarColor:this.options.progressBarColor},e)]]}}),ha=/(^|[^`])`([^`]+)`(?!`)/,ma=/(^|[^`])`([^`]+)`(?!`)/g,ga=ne.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",I(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Se({find:ha,type:this.type})]},addPasteRules(){return[be({find:ma,type:this.type})]}}),ya=/^\s*>\s$/,ba=U.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return["blockquote",I(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Ce({find:ya,type:this.type})]}}),wa=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,Ma=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Ea=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,ka=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Sa=ne.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return["strong",I(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Se({find:wa,type:this.type}),Se({find:Ea,type:this.type})]},addPasteRules(){return[be({find:Ma,type:this.type}),be({find:ka,type:this.type})]}}),xa="listItem",tn="textStyle",nn=/^\s*([-+*])\s$/,Ta=U.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",I(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(xa,this.editor.getAttributes(tn)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=Ce({find:nn,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=Ce({find:nn,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(tn),editor:this.editor})),[e]}}),Ca=/^```([a-z]+)?[\s\n]$/,va=/^~~~([a-z]+)?[\s\n]$/,Wn=U.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options,i=[...((t=e.firstElementChild)===null||t===void 0?void 0:t.classList)||[]].filter(o=>o.startsWith(n)).map(o=>o.replace(n,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",I(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=t.pos===1;return!e||t.parent.type.name!==this.name?!1:n||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:n}=t,{$from:s,empty:r}=n;if(!r||s.parent.type!==this.type)return!1;const i=s.parentOffset===s.parent.nodeSize-2,o=s.parent.textContent.endsWith(`

`);return!i||!o?!1:e.chain().command(({tr:a})=>(a.delete(s.pos-2,s.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:n,doc:s}=t,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type||!(r.parentOffset===r.parent.nodeSize-2))return!1;const a=r.after();return a===void 0?!1:s.nodeAt(a)?e.commands.command(({tr:u})=>(u.setSelection(ge.near(s.resolve(a))),!0)):e.commands.exitCode()}}},addInputRules(){return[pt({find:Ca,type:this.type,getAttributes:e=>({language:e[1]})}),pt({find:va,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new K({key:new Q("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),s=t.clipboardData.getData("vscode-editor-data"),r=s?JSON.parse(s):void 0,i=r==null?void 0:r.mode;if(!n||!i)return!1;const{tr:o,schema:a}=e.state,l=a.text(n.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:i},l)),o.selection.$from.parent.type!==this.type&&o.setSelection(X.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),e.dispatch(o),!0}}})]}}),Aa=z.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[_s(this.options)]}}),Oa=U.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",I(this.options.HTMLAttributes,e)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:s})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:r,storedMarks:i}=n;if(r.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=s.extensionManager,l=i||r.$to.parentOffset&&r.$from.marks();return t().insertContent({type:this.name}).command(({tr:u,dispatch:d})=>{if(d&&l&&o){const c=l.filter(f=>a.includes(f.type.name));u.ensureMarks(c)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),_a=U.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,I(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>pt({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}}),La=z.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>Rs(e,t),redo:()=>({state:e,dispatch:t})=>Ps(e,t)}},addProseMirrorPlugins(){return[Ns(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),Ra=U.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",I(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{const{selection:n}=t,{$from:s,$to:r}=n,i=e();return s.parentOffset===0?i.insertContentAt({from:Math.max(s.pos-1,0),to:r.pos},{type:this.name}):Rn(n)?i.insertContentAt(r.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({tr:o,dispatch:a})=>{var l;if(a){const{$to:u}=o.selection,d=u.end();if(u.nodeAfter)u.nodeAfter.isTextblock?o.setSelection(X.create(o.doc,u.pos+1)):u.nodeAfter.isBlock?o.setSelection(ke.create(o.doc,u.pos)):o.setSelection(X.create(o.doc,u.pos));else{const c=(l=u.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();c&&(o.insert(d,c),o.setSelection(X.create(o.doc,d+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Nn({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),Pa=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,Na=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Ia=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,$a=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Ha=ne.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",I(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Se({find:Pa,type:this.type}),Se({find:Ia,type:this.type})]},addPasteRules(){return[be({find:Na,type:this.type}),be({find:$a,type:this.type})]}}),Da="listItem",sn="textStyle",rn=/^(\d+)\.\s$/,Ba=U.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:void 0,parseHTML:e=>e.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){const{start:t,...n}=e;return t===1?["ol",I(this.options.HTMLAttributes,n),0]:["ol",I(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Da,this.editor.getAttributes(sn)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=Ce({find:rn,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=Ce({find:rn,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(sn)}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1],editor:this.editor})),[e]}}),ja=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,Fa=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,za=ne.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",I(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Se({find:ja,type:this.type})]},addPasteRules(){return[be({find:Fa,type:this.type})]}}),vu=z.create({name:"starterKit",addExtensions(){var e,t,n,s,r,i,o,a,l,u,d,c,f,p,m,h,y,g;const w=[];return this.options.bold!==!1&&w.push(Sa.configure((e=this.options)===null||e===void 0?void 0:e.bold)),this.options.blockquote!==!1&&w.push(ba.configure((t=this.options)===null||t===void 0?void 0:t.blockquote)),this.options.bulletList!==!1&&w.push(Ta.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&w.push(ga.configure((s=this.options)===null||s===void 0?void 0:s.code)),this.options.codeBlock!==!1&&w.push(Wn.configure((r=this.options)===null||r===void 0?void 0:r.codeBlock)),this.options.document!==!1&&w.push(Ao.configure((i=this.options)===null||i===void 0?void 0:i.document)),this.options.dropcursor!==!1&&w.push(Aa.configure((o=this.options)===null||o===void 0?void 0:o.dropcursor)),this.options.gapcursor!==!1&&w.push(ia.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&w.push(Oa.configure((l=this.options)===null||l===void 0?void 0:l.hardBreak)),this.options.heading!==!1&&w.push(_a.configure((u=this.options)===null||u===void 0?void 0:u.heading)),this.options.history!==!1&&w.push(La.configure((d=this.options)===null||d===void 0?void 0:d.history)),this.options.horizontalRule!==!1&&w.push(Ra.configure((c=this.options)===null||c===void 0?void 0:c.horizontalRule)),this.options.italic!==!1&&w.push(Ha.configure((f=this.options)===null||f===void 0?void 0:f.italic)),this.options.listItem!==!1&&w.push(No.configure((p=this.options)===null||p===void 0?void 0:p.listItem)),this.options.orderedList!==!1&&w.push(Ba.configure((m=this.options)===null||m===void 0?void 0:m.orderedList)),this.options.paragraph!==!1&&w.push(Io.configure((h=this.options)===null||h===void 0?void 0:h.paragraph)),this.options.strike!==!1&&w.push(za.configure((y=this.options)===null||y===void 0?void 0:y.strike)),this.options.text!==!1&&w.push($o.configure((g=this.options)===null||g===void 0?void 0:g.text)),w}}),Ua=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,Au=U.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:e}){return["img",I(this.options.HTMLAttributes,e)]},addCommands(){return{setImage:e=>({commands:t})=>t.insertContent({type:this.name,attrs:e})}},addInputRules(){return[Nn({find:Ua,type:this.type,getAttributes:e=>{const[,,t,n,s]=e;return{src:n,alt:t,title:s}}})]}});function Wa(e){var t;const{char:n,allowSpaces:s,allowToIncludeChar:r,allowedPrefixes:i,startOfLine:o,$position:a}=e,l=s&&!r,u=to(n),d=new RegExp(`\\s${u}$`),c=o?"^":"",f=r?"":u,p=l?new RegExp(`${c}${u}.*?(?=\\s${f}|$)`,"gm"):new RegExp(`${c}(?:^)?${u}[^\\s${f}]*`,"gm"),m=((t=a.nodeBefore)===null||t===void 0?void 0:t.isText)&&a.nodeBefore.text;if(!m)return null;const h=a.pos-m.length,y=Array.from(m.matchAll(p)).pop();if(!y||y.input===void 0||y.index===void 0)return null;const g=y.input.slice(Math.max(0,y.index-1),y.index),w=new RegExp(`^[${i==null?void 0:i.join("")}\0]?$`).test(g);if(i!==null&&!w)return null;const S=h+y.index;let C=S+y[0].length;return l&&d.test(m.slice(C-1,C+1))&&(y[0]+=" ",C+=1),S<a.pos&&C>=a.pos?{range:{from:S,to:C},query:y[0].slice(n.length),text:y[0]}:null}const Ka=new Q("suggestion");function Va({pluginKey:e=Ka,editor:t,char:n="@",allowSpaces:s=!1,allowToIncludeChar:r=!1,allowedPrefixes:i=[" "],startOfLine:o=!1,decorationTag:a="span",decorationClass:l="suggestion",command:u=()=>null,items:d=()=>[],render:c=()=>({}),allow:f=()=>!0,findSuggestionMatch:p=Wa}){let m;const h=c==null?void 0:c(),y=new K({key:e,view(){return{update:async(g,w)=>{var S,C,L,k,R,F,V;const $=(S=this.key)===null||S===void 0?void 0:S.getState(w),Y=(C=this.key)===null||C===void 0?void 0:C.getState(g.state),de=$.active&&Y.active&&$.range.from!==Y.range.from,_e=!$.active&&Y.active,Le=$.active&&!Y.active,ae=!_e&&!Le&&$.query!==Y.query,fe=_e||de&&ae,b=ae||de,x=Le||de&&ae;if(!fe&&!b&&!x)return;const A=x&&!fe?$:Y,P=g.dom.querySelector(`[data-decoration-id="${A.decorationId}"]`);m={editor:t,range:A.range,query:A.query,text:A.text,items:[],command:H=>u({editor:t,range:A.range,props:H}),decorationNode:P,clientRect:P?()=>{var H;const{decorationId:Z}=(H=this.key)===null||H===void 0?void 0:H.getState(t.state),te=g.dom.querySelector(`[data-decoration-id="${Z}"]`);return(te==null?void 0:te.getBoundingClientRect())||null}:null},fe&&((L=h==null?void 0:h.onBeforeStart)===null||L===void 0||L.call(h,m)),b&&((k=h==null?void 0:h.onBeforeUpdate)===null||k===void 0||k.call(h,m)),(b||fe)&&(m.items=await d({editor:t,query:A.query})),x&&((R=h==null?void 0:h.onExit)===null||R===void 0||R.call(h,m)),b&&((F=h==null?void 0:h.onUpdate)===null||F===void 0||F.call(h,m)),fe&&((V=h==null?void 0:h.onStart)===null||V===void 0||V.call(h,m))},destroy:()=>{var g;m&&((g=h==null?void 0:h.onExit)===null||g===void 0||g.call(h,m))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(g,w,S,C){const{isEditable:L}=t,{composing:k}=t.view,{selection:R}=g,{empty:F,from:V}=R,$={...w};if($.composing=k,L&&(F||t.view.composing)){(V<w.range.from||V>w.range.to)&&!k&&!w.composing&&($.active=!1);const Y=p({char:n,allowSpaces:s,allowToIncludeChar:r,allowedPrefixes:i,startOfLine:o,$position:R.$from}),de=`id_${Math.floor(Math.random()*4294967295)}`;Y&&f({editor:t,state:C,range:Y.range,isActive:w.active})?($.active=!0,$.decorationId=w.decorationId?w.decorationId:de,$.range=Y.range,$.query=Y.query,$.text=Y.text):$.active=!1}else $.active=!1;return $.active||($.decorationId=null,$.range={from:0,to:0},$.query=null,$.text=null),$}},props:{handleKeyDown(g,w){var S;const{active:C,range:L}=y.getState(g.state);return C&&((S=h==null?void 0:h.onKeyDown)===null||S===void 0?void 0:S.call(h,{view:g,event:w,range:L}))||!1},decorations(g){const{active:w,range:S,decorationId:C}=y.getState(g);return w?yt.create(g.doc,[gt.inline(S.from,S.to,{nodeName:a,class:l,"data-decoration-id":C})]):null}}});return y}const qa=new Q("mention"),Ou=U.create({name:"mention",priority:101,addOptions(){return{HTMLAttributes:{},renderText({options:e,node:t}){var n;return`${e.suggestion.char}${(n=t.attrs.label)!==null&&n!==void 0?n:t.attrs.id}`},deleteTriggerWithBackspace:!1,renderHTML({options:e,node:t}){var n;return["span",I(this.HTMLAttributes,e.HTMLAttributes),`${e.suggestion.char}${(n=t.attrs.label)!==null&&n!==void 0?n:t.attrs.id}`]},suggestion:{char:"@",pluginKey:qa,command:({editor:e,range:t,props:n})=>{var s,r,i;const o=e.view.state.selection.$to.nodeAfter;((s=o==null?void 0:o.text)===null||s===void 0?void 0:s.startsWith(" "))&&(t.to+=1),e.chain().focus().insertContentAt(t,[{type:this.name,attrs:n},{type:"text",text:" "}]).run(),(i=(r=e.view.dom.ownerDocument.defaultView)===null||r===void 0?void 0:r.getSelection())===null||i===void 0||i.collapseToEnd()},allow:({state:e,range:t})=>{const n=e.doc.resolve(t.from),s=e.schema.nodes[this.name];return!!n.parent.type.contentMatch.matchType(s)}}}},group:"inline",inline:!0,selectable:!1,atom:!0,addAttributes(){return{id:{default:null,parseHTML:e=>e.getAttribute("data-id"),renderHTML:e=>e.id?{"data-id":e.id}:{}},label:{default:null,parseHTML:e=>e.getAttribute("data-label"),renderHTML:e=>e.label?{"data-label":e.label}:{}}}},parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({node:e,HTMLAttributes:t}){if(this.options.renderLabel!==void 0)return console.warn("renderLabel is deprecated use renderText and renderHTML instead"),["span",I({"data-type":this.name},this.options.HTMLAttributes,t),this.options.renderLabel({options:this.options,node:e})];const n={...this.options};n.HTMLAttributes=I({"data-type":this.name},this.options.HTMLAttributes,t);const s=this.options.renderHTML({options:n,node:e});return typeof s=="string"?["span",I({"data-type":this.name},this.options.HTMLAttributes,t),s]:s},renderText({node:e}){return this.options.renderLabel!==void 0?(console.warn("renderLabel is deprecated use renderText and renderHTML instead"),this.options.renderLabel({options:this.options,node:e})):this.options.renderText({options:this.options,node:e})},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:e,state:t})=>{let n=!1;const{selection:s}=t,{empty:r,anchor:i}=s;return r?(t.doc.nodesBetween(i-1,i,(o,a)=>{if(o.type.name===this.name)return n=!0,e.insertText(this.options.deleteTriggerWithBackspace?"":this.options.suggestion.char||"",a,a+o.nodeSize),!1}),n):!1})}},addProseMirrorPlugins(){return[Va({editor:this.editor,...this.options.suggestion})]}});function Ga(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Kn(e){return e instanceof Map?e.clear=e.delete=e.set=function(){throw new Error("map is read-only")}:e instanceof Set&&(e.add=e.clear=e.delete=function(){throw new Error("set is read-only")}),Object.freeze(e),Object.getOwnPropertyNames(e).forEach(t=>{const n=e[t],s=typeof n;(s==="object"||s==="function")&&!Object.isFrozen(n)&&Kn(n)}),e}class on{constructor(t){t.data===void 0&&(t.data={}),this.data=t.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}}function Vn(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function le(e,...t){const n=Object.create(null);for(const s in e)n[s]=e[s];return t.forEach(function(s){for(const r in s)n[r]=s[r]}),n}const Qa="</span>",an=e=>!!e.scope,Ja=(e,{prefix:t})=>{if(e.startsWith("language:"))return e.replace("language:","language-");if(e.includes(".")){const n=e.split(".");return[`${t}${n.shift()}`,...n.map((s,r)=>`${s}${"_".repeat(r+1)}`)].join(" ")}return`${t}${e}`};class Ya{constructor(t,n){this.buffer="",this.classPrefix=n.classPrefix,t.walk(this)}addText(t){this.buffer+=Vn(t)}openNode(t){if(!an(t))return;const n=Ja(t.scope,{prefix:this.classPrefix});this.span(n)}closeNode(t){an(t)&&(this.buffer+=Qa)}value(){return this.buffer}span(t){this.buffer+=`<span class="${t}">`}}const ln=(e={})=>{const t={children:[]};return Object.assign(t,e),t};class At{constructor(){this.rootNode=ln(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(t){this.top.children.push(t)}openNode(t){const n=ln({scope:t});this.add(n),this.stack.push(n)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(t){return this.constructor._walk(t,this.rootNode)}static _walk(t,n){return typeof n=="string"?t.addText(n):n.children&&(t.openNode(n),n.children.forEach(s=>this._walk(t,s)),t.closeNode(n)),t}static _collapse(t){typeof t!="string"&&t.children&&(t.children.every(n=>typeof n=="string")?t.children=[t.children.join("")]:t.children.forEach(n=>{At._collapse(n)}))}}class Xa extends At{constructor(t){super(),this.options=t}addText(t){t!==""&&this.add(t)}startScope(t){this.openNode(t)}endScope(){this.closeNode()}__addSublanguage(t,n){const s=t.root;n&&(s.scope=`language:${n}`),this.add(s)}toHTML(){return new Ya(this,this.options).value()}finalize(){return this.closeAllNodes(),!0}}function ve(e){return e?typeof e=="string"?e:e.source:null}function qn(e){return we("(?=",e,")")}function Za(e){return we("(?:",e,")*")}function el(e){return we("(?:",e,")?")}function we(...e){return e.map(n=>ve(n)).join("")}function tl(e){const t=e[e.length-1];return typeof t=="object"&&t.constructor===Object?(e.splice(e.length-1,1),t):{}}function Ot(...e){return"("+(tl(e).capture?"":"?:")+e.map(s=>ve(s)).join("|")+")"}function Gn(e){return new RegExp(e.toString()+"|").exec("").length-1}function nl(e,t){const n=e&&e.exec(t);return n&&n.index===0}const sl=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function _t(e,{joinWith:t}){let n=0;return e.map(s=>{n+=1;const r=n;let i=ve(s),o="";for(;i.length>0;){const a=sl.exec(i);if(!a){o+=i;break}o+=i.substring(0,a.index),i=i.substring(a.index+a[0].length),a[0][0]==="\\"&&a[1]?o+="\\"+String(Number(a[1])+r):(o+=a[0],a[0]==="("&&n++)}return o}).map(s=>`(${s})`).join(t)}const rl=/\b\B/,Qn="[a-zA-Z]\\w*",Lt="[a-zA-Z_]\\w*",Jn="\\b\\d+(\\.\\d+)?",Yn="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",Xn="\\b(0b[01]+)",il="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",ol=(e={})=>{const t=/^#![ ]*\//;return e.binary&&(e.begin=we(t,/.*\b/,e.binary,/\b.*/)),le({scope:"meta",begin:t,end:/$/,relevance:0,"on:begin":(n,s)=>{n.index!==0&&s.ignoreMatch()}},e)},Ae={begin:"\\\\[\\s\\S]",relevance:0},al={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[Ae]},ll={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[Ae]},ul={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},Ze=function(e,t,n={}){const s=le({scope:"comment",begin:e,end:t,contains:[]},n);s.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});const r=Ot("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return s.contains.push({begin:we(/[ ]+/,"(",r,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),s},cl=Ze("//","$"),dl=Ze("/\\*","\\*/"),fl=Ze("#","$"),pl={scope:"number",begin:Jn,relevance:0},hl={scope:"number",begin:Yn,relevance:0},ml={scope:"number",begin:Xn,relevance:0},gl={scope:"regexp",begin:/\/(?=[^/\n]*\/)/,end:/\/[gimuy]*/,contains:[Ae,{begin:/\[/,end:/\]/,relevance:0,contains:[Ae]}]},yl={scope:"title",begin:Qn,relevance:0},bl={scope:"title",begin:Lt,relevance:0},wl={begin:"\\.\\s*"+Lt,relevance:0},Ml=function(e){return Object.assign(e,{"on:begin":(t,n)=>{n.data._beginMatch=t[1]},"on:end":(t,n)=>{n.data._beginMatch!==t[1]&&n.ignoreMatch()}})};var je=Object.freeze({__proto__:null,APOS_STRING_MODE:al,BACKSLASH_ESCAPE:Ae,BINARY_NUMBER_MODE:ml,BINARY_NUMBER_RE:Xn,COMMENT:Ze,C_BLOCK_COMMENT_MODE:dl,C_LINE_COMMENT_MODE:cl,C_NUMBER_MODE:hl,C_NUMBER_RE:Yn,END_SAME_AS_BEGIN:Ml,HASH_COMMENT_MODE:fl,IDENT_RE:Qn,MATCH_NOTHING_RE:rl,METHOD_GUARD:wl,NUMBER_MODE:pl,NUMBER_RE:Jn,PHRASAL_WORDS_MODE:ul,QUOTE_STRING_MODE:ll,REGEXP_MODE:gl,RE_STARTERS_RE:il,SHEBANG:ol,TITLE_MODE:yl,UNDERSCORE_IDENT_RE:Lt,UNDERSCORE_TITLE_MODE:bl});function El(e,t){e.input[e.index-1]==="."&&t.ignoreMatch()}function kl(e,t){e.className!==void 0&&(e.scope=e.className,delete e.className)}function Sl(e,t){t&&e.beginKeywords&&(e.begin="\\b("+e.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",e.__beforeBegin=El,e.keywords=e.keywords||e.beginKeywords,delete e.beginKeywords,e.relevance===void 0&&(e.relevance=0))}function xl(e,t){Array.isArray(e.illegal)&&(e.illegal=Ot(...e.illegal))}function Tl(e,t){if(e.match){if(e.begin||e.end)throw new Error("begin & end are not supported with match");e.begin=e.match,delete e.match}}function Cl(e,t){e.relevance===void 0&&(e.relevance=1)}const vl=(e,t)=>{if(!e.beforeMatch)return;if(e.starts)throw new Error("beforeMatch cannot be used with starts");const n=Object.assign({},e);Object.keys(e).forEach(s=>{delete e[s]}),e.keywords=n.keywords,e.begin=we(n.beforeMatch,qn(n.begin)),e.starts={relevance:0,contains:[Object.assign(n,{endsParent:!0})]},e.relevance=0,delete n.beforeMatch},Al=["of","and","for","in","not","or","if","then","parent","list","value"],Ol="keyword";function Zn(e,t,n=Ol){const s=Object.create(null);return typeof e=="string"?r(n,e.split(" ")):Array.isArray(e)?r(n,e):Object.keys(e).forEach(function(i){Object.assign(s,Zn(e[i],t,i))}),s;function r(i,o){t&&(o=o.map(a=>a.toLowerCase())),o.forEach(function(a){const l=a.split("|");s[l[0]]=[i,_l(l[0],l[1])]})}}function _l(e,t){return t?Number(t):Ll(e)?0:1}function Ll(e){return Al.includes(e.toLowerCase())}const un={},ye=e=>{console.error(e)},cn=(e,...t)=>{console.log(`WARN: ${e}`,...t)},Me=(e,t)=>{un[`${e}/${t}`]||(console.log(`Deprecated as of ${e}. ${t}`),un[`${e}/${t}`]=!0)},Ve=new Error;function es(e,t,{key:n}){let s=0;const r=e[n],i={},o={};for(let a=1;a<=t.length;a++)o[a+s]=r[a],i[a+s]=!0,s+=Gn(t[a-1]);e[n]=o,e[n]._emit=i,e[n]._multi=!0}function Rl(e){if(Array.isArray(e.begin)){if(e.skip||e.excludeBegin||e.returnBegin)throw ye("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),Ve;if(typeof e.beginScope!="object"||e.beginScope===null)throw ye("beginScope must be object"),Ve;es(e,e.begin,{key:"beginScope"}),e.begin=_t(e.begin,{joinWith:""})}}function Pl(e){if(Array.isArray(e.end)){if(e.skip||e.excludeEnd||e.returnEnd)throw ye("skip, excludeEnd, returnEnd not compatible with endScope: {}"),Ve;if(typeof e.endScope!="object"||e.endScope===null)throw ye("endScope must be object"),Ve;es(e,e.end,{key:"endScope"}),e.end=_t(e.end,{joinWith:""})}}function Nl(e){e.scope&&typeof e.scope=="object"&&e.scope!==null&&(e.beginScope=e.scope,delete e.scope)}function Il(e){Nl(e),typeof e.beginScope=="string"&&(e.beginScope={_wrap:e.beginScope}),typeof e.endScope=="string"&&(e.endScope={_wrap:e.endScope}),Rl(e),Pl(e)}function $l(e){function t(o,a){return new RegExp(ve(o),"m"+(e.case_insensitive?"i":"")+(e.unicodeRegex?"u":"")+(a?"g":""))}class n{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(a,l){l.position=this.position++,this.matchIndexes[this.matchAt]=l,this.regexes.push([l,a]),this.matchAt+=Gn(a)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const a=this.regexes.map(l=>l[1]);this.matcherRe=t(_t(a,{joinWith:"|"}),!0),this.lastIndex=0}exec(a){this.matcherRe.lastIndex=this.lastIndex;const l=this.matcherRe.exec(a);if(!l)return null;const u=l.findIndex((c,f)=>f>0&&c!==void 0),d=this.matchIndexes[u];return l.splice(0,u),Object.assign(l,d)}}class s{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(a){if(this.multiRegexes[a])return this.multiRegexes[a];const l=new n;return this.rules.slice(a).forEach(([u,d])=>l.addRule(u,d)),l.compile(),this.multiRegexes[a]=l,l}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(a,l){this.rules.push([a,l]),l.type==="begin"&&this.count++}exec(a){const l=this.getMatcher(this.regexIndex);l.lastIndex=this.lastIndex;let u=l.exec(a);if(this.resumingScanAtSamePosition()&&!(u&&u.index===this.lastIndex)){const d=this.getMatcher(0);d.lastIndex=this.lastIndex+1,u=d.exec(a)}return u&&(this.regexIndex+=u.position+1,this.regexIndex===this.count&&this.considerAll()),u}}function r(o){const a=new s;return o.contains.forEach(l=>a.addRule(l.begin,{rule:l,type:"begin"})),o.terminatorEnd&&a.addRule(o.terminatorEnd,{type:"end"}),o.illegal&&a.addRule(o.illegal,{type:"illegal"}),a}function i(o,a){const l=o;if(o.isCompiled)return l;[kl,Tl,Il,vl].forEach(d=>d(o,a)),e.compilerExtensions.forEach(d=>d(o,a)),o.__beforeBegin=null,[Sl,xl,Cl].forEach(d=>d(o,a)),o.isCompiled=!0;let u=null;return typeof o.keywords=="object"&&o.keywords.$pattern&&(o.keywords=Object.assign({},o.keywords),u=o.keywords.$pattern,delete o.keywords.$pattern),u=u||/\w+/,o.keywords&&(o.keywords=Zn(o.keywords,e.case_insensitive)),l.keywordPatternRe=t(u,!0),a&&(o.begin||(o.begin=/\B|\b/),l.beginRe=t(l.begin),!o.end&&!o.endsWithParent&&(o.end=/\B|\b/),o.end&&(l.endRe=t(l.end)),l.terminatorEnd=ve(l.end)||"",o.endsWithParent&&a.terminatorEnd&&(l.terminatorEnd+=(o.end?"|":"")+a.terminatorEnd)),o.illegal&&(l.illegalRe=t(o.illegal)),o.contains||(o.contains=[]),o.contains=[].concat(...o.contains.map(function(d){return Hl(d==="self"?o:d)})),o.contains.forEach(function(d){i(d,l)}),o.starts&&i(o.starts,a),l.matcher=r(l),l}if(e.compilerExtensions||(e.compilerExtensions=[]),e.contains&&e.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return e.classNameAliases=le(e.classNameAliases||{}),i(e)}function ts(e){return e?e.endsWithParent||ts(e.starts):!1}function Hl(e){return e.variants&&!e.cachedVariants&&(e.cachedVariants=e.variants.map(function(t){return le(e,{variants:null},t)})),e.cachedVariants?e.cachedVariants:ts(e)?le(e,{starts:e.starts?le(e.starts):null}):Object.isFrozen(e)?le(e):e}var Dl="11.10.0";class Bl extends Error{constructor(t,n){super(t),this.name="HTMLInjectionError",this.html=n}}const ut=Vn,dn=le,fn=Symbol("nomatch"),jl=7,ns=function(e){const t=Object.create(null),n=Object.create(null),s=[];let r=!0;const i="Could not find the language '{}', did you forget to load/include a language module?",o={disableAutodetect:!0,name:"Plain text",contains:[]};let a={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:Xa};function l(b){return a.noHighlightRe.test(b)}function u(b){let x=b.className+" ";x+=b.parentNode?b.parentNode.className:"";const A=a.languageDetectRe.exec(x);if(A){const P=V(A[1]);return P||(cn(i.replace("{}",A[1])),cn("Falling back to no-highlight mode for this block.",b)),P?A[1]:"no-highlight"}return x.split(/\s+/).find(P=>l(P)||V(P))}function d(b,x,A){let P="",H="";typeof x=="object"?(P=b,A=x.ignoreIllegals,H=x.language):(Me("10.7.0","highlight(lang, code, ...args) has been deprecated."),Me("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),H=b,P=x),A===void 0&&(A=!0);const Z={code:P,language:H};ae("before:highlight",Z);const te=Z.result?Z.result:c(Z.language,Z.code,A);return te.code=Z.code,ae("after:highlight",te),te}function c(b,x,A,P){const H=Object.create(null);function Z(M,T){return M.keywords[T]}function te(){if(!v.keywords){q.addText(D);return}let M=0;v.keywordPatternRe.lastIndex=0;let T=v.keywordPatternRe.exec(D),_="";for(;T;){_+=D.substring(M,T.index);const N=re.case_insensitive?T[0].toLowerCase():T[0],J=Z(v,N);if(J){const[ie,us]=J;if(q.addText(_),_="",H[N]=(H[N]||0)+1,H[N]<=jl&&(Ne+=us),ie.startsWith("_"))_+=T[0];else{const cs=re.classNameAliases[ie]||ie;se(T[0],cs)}}else _+=T[0];M=v.keywordPatternRe.lastIndex,T=v.keywordPatternRe.exec(D)}_+=D.substring(M),q.addText(_)}function Re(){if(D==="")return;let M=null;if(typeof v.subLanguage=="string"){if(!t[v.subLanguage]){q.addText(D);return}M=c(v.subLanguage,D,!0,$t[v.subLanguage]),$t[v.subLanguage]=M._top}else M=p(D,v.subLanguage.length?v.subLanguage:null);v.relevance>0&&(Ne+=M.relevance),q.__addSublanguage(M._emitter,M.language)}function ee(){v.subLanguage!=null?Re():te(),D=""}function se(M,T){M!==""&&(q.startScope(T),q.addText(M),q.endScope())}function Rt(M,T){let _=1;const N=T.length-1;for(;_<=N;){if(!M._emit[_]){_++;continue}const J=re.classNameAliases[M[_]]||M[_],ie=T[_];J?se(ie,J):(D=ie,te(),D=""),_++}}function Pt(M,T){return M.scope&&typeof M.scope=="string"&&q.openNode(re.classNameAliases[M.scope]||M.scope),M.beginScope&&(M.beginScope._wrap?(se(D,re.classNameAliases[M.beginScope._wrap]||M.beginScope._wrap),D=""):M.beginScope._multi&&(Rt(M.beginScope,T),D="")),v=Object.create(M,{parent:{value:v}}),v}function Nt(M,T,_){let N=nl(M.endRe,_);if(N){if(M["on:end"]){const J=new on(M);M["on:end"](T,J),J.isMatchIgnored&&(N=!1)}if(N){for(;M.endsParent&&M.parent;)M=M.parent;return M}}if(M.endsWithParent)return Nt(M.parent,T,_)}function rs(M){return v.matcher.regexIndex===0?(D+=M[0],1):(nt=!0,0)}function is(M){const T=M[0],_=M.rule,N=new on(_),J=[_.__beforeBegin,_["on:begin"]];for(const ie of J)if(ie&&(ie(M,N),N.isMatchIgnored))return rs(T);return _.skip?D+=T:(_.excludeBegin&&(D+=T),ee(),!_.returnBegin&&!_.excludeBegin&&(D=T)),Pt(_,M),_.returnBegin?0:T.length}function os(M){const T=M[0],_=x.substring(M.index),N=Nt(v,M,_);if(!N)return fn;const J=v;v.endScope&&v.endScope._wrap?(ee(),se(T,v.endScope._wrap)):v.endScope&&v.endScope._multi?(ee(),Rt(v.endScope,M)):J.skip?D+=T:(J.returnEnd||J.excludeEnd||(D+=T),ee(),J.excludeEnd&&(D=T));do v.scope&&q.closeNode(),!v.skip&&!v.subLanguage&&(Ne+=v.relevance),v=v.parent;while(v!==N.parent);return N.starts&&Pt(N.starts,M),J.returnEnd?0:T.length}function as(){const M=[];for(let T=v;T!==re;T=T.parent)T.scope&&M.unshift(T.scope);M.forEach(T=>q.openNode(T))}let Pe={};function It(M,T){const _=T&&T[0];if(D+=M,_==null)return ee(),0;if(Pe.type==="begin"&&T.type==="end"&&Pe.index===T.index&&_===""){if(D+=x.slice(T.index,T.index+1),!r){const N=new Error(`0 width match regex (${b})`);throw N.languageName=b,N.badRule=Pe.rule,N}return 1}if(Pe=T,T.type==="begin")return is(T);if(T.type==="illegal"&&!A){const N=new Error('Illegal lexeme "'+_+'" for mode "'+(v.scope||"<unnamed>")+'"');throw N.mode=v,N}else if(T.type==="end"){const N=os(T);if(N!==fn)return N}if(T.type==="illegal"&&_==="")return 1;if(tt>1e5&&tt>T.index*3)throw new Error("potential infinite loop, way more iterations than matches");return D+=_,_.length}const re=V(b);if(!re)throw ye(i.replace("{}",b)),new Error('Unknown language: "'+b+'"');const ls=$l(re);let et="",v=P||ls;const $t={},q=new a.__emitter(a);as();let D="",Ne=0,pe=0,tt=0,nt=!1;try{if(re.__emitTokens)re.__emitTokens(x,q);else{for(v.matcher.considerAll();;){tt++,nt?nt=!1:v.matcher.considerAll(),v.matcher.lastIndex=pe;const M=v.matcher.exec(x);if(!M)break;const T=x.substring(pe,M.index),_=It(T,M);pe=M.index+_}It(x.substring(pe))}return q.finalize(),et=q.toHTML(),{language:b,value:et,relevance:Ne,illegal:!1,_emitter:q,_top:v}}catch(M){if(M.message&&M.message.includes("Illegal"))return{language:b,value:ut(x),illegal:!0,relevance:0,_illegalBy:{message:M.message,index:pe,context:x.slice(pe-100,pe+100),mode:M.mode,resultSoFar:et},_emitter:q};if(r)return{language:b,value:ut(x),illegal:!1,relevance:0,errorRaised:M,_emitter:q,_top:v};throw M}}function f(b){const x={value:ut(b),illegal:!1,relevance:0,_top:o,_emitter:new a.__emitter(a)};return x._emitter.addText(b),x}function p(b,x){x=x||a.languages||Object.keys(t);const A=f(b),P=x.filter(V).filter(Y).map(ee=>c(ee,b,!1));P.unshift(A);const H=P.sort((ee,se)=>{if(ee.relevance!==se.relevance)return se.relevance-ee.relevance;if(ee.language&&se.language){if(V(ee.language).supersetOf===se.language)return 1;if(V(se.language).supersetOf===ee.language)return-1}return 0}),[Z,te]=H,Re=Z;return Re.secondBest=te,Re}function m(b,x,A){const P=x&&n[x]||A;b.classList.add("hljs"),b.classList.add(`language-${P}`)}function h(b){let x=null;const A=u(b);if(l(A))return;if(ae("before:highlightElement",{el:b,language:A}),b.dataset.highlighted){console.log("Element previously highlighted. To highlight again, first unset `dataset.highlighted`.",b);return}if(b.children.length>0&&(a.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(b)),a.throwUnescapedHTML))throw new Bl("One of your code blocks includes unescaped HTML.",b.innerHTML);x=b;const P=x.textContent,H=A?d(P,{language:A,ignoreIllegals:!0}):p(P);b.innerHTML=H.value,b.dataset.highlighted="yes",m(b,A,H.language),b.result={language:H.language,re:H.relevance,relevance:H.relevance},H.secondBest&&(b.secondBest={language:H.secondBest.language,relevance:H.secondBest.relevance}),ae("after:highlightElement",{el:b,result:H,text:P})}function y(b){a=dn(a,b)}const g=()=>{C(),Me("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function w(){C(),Me("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let S=!1;function C(){if(document.readyState==="loading"){S=!0;return}document.querySelectorAll(a.cssSelector).forEach(h)}function L(){S&&C()}typeof window<"u"&&window.addEventListener&&window.addEventListener("DOMContentLoaded",L,!1);function k(b,x){let A=null;try{A=x(e)}catch(P){if(ye("Language definition for '{}' could not be registered.".replace("{}",b)),r)ye(P);else throw P;A=o}A.name||(A.name=b),t[b]=A,A.rawDefinition=x.bind(null,e),A.aliases&&$(A.aliases,{languageName:b})}function R(b){delete t[b];for(const x of Object.keys(n))n[x]===b&&delete n[x]}function F(){return Object.keys(t)}function V(b){return b=(b||"").toLowerCase(),t[b]||t[n[b]]}function $(b,{languageName:x}){typeof b=="string"&&(b=[b]),b.forEach(A=>{n[A.toLowerCase()]=x})}function Y(b){const x=V(b);return x&&!x.disableAutodetect}function de(b){b["before:highlightBlock"]&&!b["before:highlightElement"]&&(b["before:highlightElement"]=x=>{b["before:highlightBlock"](Object.assign({block:x.el},x))}),b["after:highlightBlock"]&&!b["after:highlightElement"]&&(b["after:highlightElement"]=x=>{b["after:highlightBlock"](Object.assign({block:x.el},x))})}function _e(b){de(b),s.push(b)}function Le(b){const x=s.indexOf(b);x!==-1&&s.splice(x,1)}function ae(b,x){const A=b;s.forEach(function(P){P[A]&&P[A](x)})}function fe(b){return Me("10.7.0","highlightBlock will be removed entirely in v12.0"),Me("10.7.0","Please use highlightElement now."),h(b)}Object.assign(e,{highlight:d,highlightAuto:p,highlightAll:C,highlightElement:h,highlightBlock:fe,configure:y,initHighlighting:g,initHighlightingOnLoad:w,registerLanguage:k,unregisterLanguage:R,listLanguages:F,getLanguage:V,registerAliases:$,autoDetection:Y,inherit:dn,addPlugin:_e,removePlugin:Le}),e.debugMode=function(){r=!1},e.safeMode=function(){r=!0},e.versionString=Dl,e.regex={concat:we,lookahead:qn,either:Ot,optional:el,anyNumberOfTimes:Za};for(const b in je)typeof je[b]=="object"&&Kn(je[b]);return Object.assign(e,je),e},xe=ns({});xe.newInstance=()=>ns({});var Fl=xe;xe.HighlightJS=xe;xe.default=xe;var zl=Ga(Fl);function ss(e,t=[]){return e.map(n=>{const s=[...t,...n.properties?n.properties.className:[]];return n.children?ss(n.children,s):{text:n.value,classes:s}}).flat()}function pn(e){return e.value||e.children||[]}function Ul(e){return!!zl.getLanguage(e)}function hn({doc:e,name:t,lowlight:n,defaultLanguage:s}){const r=[];return dt(e,i=>i.type.name===t).forEach(i=>{var o;let a=i.pos+1;const l=i.node.attrs.language||s,u=n.listLanguages(),d=l&&(u.includes(l)||Ul(l)||!((o=n.registered)===null||o===void 0)&&o.call(n,l))?pn(n.highlight(l,i.node.textContent)):pn(n.highlightAuto(i.node.textContent));ss(d).forEach(c=>{const f=a+c.text.length;if(c.classes.length){const p=gt.inline(a,f,{class:c.classes.join(" ")});r.push(p)}a=f})}),yt.create(e,r)}function Wl(e){return typeof e=="function"}function Kl({name:e,lowlight:t,defaultLanguage:n}){if(!["highlight","highlightAuto","listLanguages"].every(r=>Wl(t[r])))throw Error("You should provide an instance of lowlight to use the code-block-lowlight extension");const s=new K({key:new Q("lowlight"),state:{init:(r,{doc:i})=>hn({doc:i,name:e,lowlight:t,defaultLanguage:n}),apply:(r,i,o,a)=>{const l=o.selection.$head.parent.type.name,u=a.selection.$head.parent.type.name,d=dt(o.doc,f=>f.type.name===e),c=dt(a.doc,f=>f.type.name===e);return r.docChanged&&([l,u].includes(e)||c.length!==d.length||r.steps.some(f=>f.from!==void 0&&f.to!==void 0&&d.some(p=>p.pos>=f.from&&p.pos+p.node.nodeSize<=f.to)))?hn({doc:r.doc,name:e,lowlight:t,defaultLanguage:n}):i.map(r.mapping,r.doc)}},props:{decorations(r){return s.getState(r)}}});return s}const _u=Wn.extend({addOptions(){var e;return{...(e=this.parent)===null||e===void 0?void 0:e.call(this),lowlight:{},languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},addProseMirrorPlugins(){var e;return[...((e=this.parent)===null||e===void 0?void 0:e.call(this))||[],Kl({name:this.name,lowlight:this.options.lowlight,defaultLanguage:this.options.defaultLanguage})]}});export{au as B,_u as C,Ao as D,lu as E,du as F,ia as G,_a as H,Au as I,No as L,Ou as M,pu as N,Io as P,hu as R,vu as S,mu as T,Mu as U,Cu as Y,To as a,fu as b,gu as c,$o as d,wu as e,ga as f,yu as g,ku as h,Tu as i,xu as j,Su as k,Eu as l,I as m,bu as n,cu as o,uu as u};
